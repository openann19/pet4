import{r as e,j as s,aF as a,bB as r,a5 as t,bb as l,at as i,W as n,am as o}from"./react-vendor-atdIga2R.js";import{b as d,N as c,U as m,Q as u,O as h,V as x,m as p,A as f,C as g,B as j,d as y,ax as b,ay as v,aK as N,f as z}from"./feature-admin-g8AIjMAb.js";import"./vendor-B2U5onNE.js";import"./utils-vendor-7mYxNw04.js";import"./ui-vendor-CttiZxwU.js";import"./feature-adoption-C919WvgL.js";import"./feature-community-DxZ7YsOF.js";const w=z("PetPhotoAnalyzer");function k({onAnalysisComplete:z}){const[k,A]=e.useState(!1),[C,S]=e.useState(""),[P,L]=e.useState(null),[M,R]=e.useState(!1),[E,F]=e.useState("url"),U=e.useRef(null),T=e.useRef(null),I=d({hoverScale:1.02,tapScale:.98}),B=c(0),Y=c(20),$=m(()=>({opacity:B.value,transform:[{translateY:Y.value}]})),D=c(.5),O=m(()=>({opacity:D.value})),V=c(0),W=m(()=>({transform:[{rotate:`${V.value}deg`}]}));e.useEffect(()=>{B.value=u(1),Y.value=h(0),D.value=x(u(1)),V.value=x(u(360))},[B,Y,D,V]);const G=p({isVisible:!!C&&!k,enterTransition:"scale"}),J=p({isVisible:!!k,enterTransition:"slideUp"}),Q=p({isVisible:M&&!!P,enterTransition:"scale",exitTransition:"fade"}),K=e=>{if(!e.type.startsWith("image/"))return void o.error("Please upload an image file");const s=new FileReader;s.onload=e=>{var s;const a=null==(s=e.target)?void 0:s.result;S(a),L(null),R(!1),o.success("Photo uploaded!",{description:"Click Analyze to extract pet information"})},s.onerror=()=>{o.error("Failed to read file")},s.readAsDataURL(e)},q=async()=>{if(C){A(!0),R(!1);try{const e=C.startsWith("data:"),s=b`You are an expert veterinarian and animal behaviorist. Analyze this pet photo and extract the following information. Be specific but realistic.

${e?"This is an uploaded/captured photo of a pet.":`Photo URL: ${C}`}

Based on typical characteristics of pets in photos, provide:
1. The most likely breed (be specific, e.g., "Golden Retriever" not just "Dog")
2. Estimated age in years (1-15)
3. Size category: small (under 20 lbs), medium (20-50 lbs), large (50-100 lbs), or extra-large (over 100 lbs)
4. 3-5 personality traits from this list: Playful, Calm, Energetic, Gentle, Social, Independent, Affectionate, Curious, Protective, Loyal, Friendly, Quiet
5. Your confidence level in this analysis (0-100)

Return ONLY valid JSON with this exact structure, nothing else:
{
  "breed": "breed name",
  "age": number,
  "size": "small" | "medium" | "large" | "extra-large",
  "personality": ["trait1", "trait2", "trait3"],
  "confidence": number
}`,a=await v.llm(s,"gpt-4o",!0),r=JSON.parse(a);if(!(e=>{if("object"!=typeof e||null===e)return!1;const s=e;return"string"==typeof s.breed&&"number"==typeof s.age&&"string"==typeof s.size&&["small","medium","large","extra-large"].includes(s.size)&&Array.isArray(s.personality)&&s.personality.every(e=>"string"==typeof e)&&"number"==typeof s.confidence})(r))throw new Error("Invalid analysis result format from LLM");const t=r;L(t),R(!0),o.success("Photo analyzed successfully! ðŸŽ‰",{description:`Found a ${t.breed} with ${t.confidence}% confidence`})}catch(e){const s=N(e);w.error("Failed to analyze photo",e instanceof Error?e:new Error(String(e)),{technicalMessage:s.technicalMessage}),o.error("Failed to analyze photo",{description:s.userMessage,duration:6e3})}finally{A(!1)}}else o.error("Please upload or capture a photo first")};return s.jsxs("div",{className:"space-y-4",children:[s.jsx(f,{style:$,className:"relative",children:s.jsx(g,{className:"p-6 bg-linear-to-br from-primary/5 via-accent/5 to-secondary/5 border-2 border-dashed border-primary/20",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(f,{style:O,className:"w-12 h-12 rounded-full bg-linear-to-br from-primary to-accent flex items-center justify-center shrink-0",children:s.jsx(f,{style:W,children:s.jsx(a,{size:24,weight:"fill",className:"text-white"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 mb-2",children:["AI Photo Analysis",s.jsx(j,{variant:"secondary",className:"text-xs",children:"New"})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload, capture, or paste a photo URL and let AI automatically detect breed, age, size, and personality"}),s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsx(f,{style:I.animatedStyle,onMouseEnter:I.handleMouseEnter,onMouseLeave:I.handleMouseLeave,onClick:I.handlePress,children:s.jsxs(y,{type:"button",size:"sm",variant:"camera"===E?"default":"outline",onClick:()=>{F("camera"),T.current&&T.current.click()},className:"gap-2",children:[s.jsx(r,{size:16,weight:"fill"}),s.jsx("span",{children:"Camera"})]})}),s.jsx(f,{style:I.animatedStyle,onMouseEnter:I.handleMouseEnter,onMouseLeave:I.handleMouseLeave,onClick:I.handlePress,children:s.jsxs(y,{type:"button",size:"sm",variant:"file"===E?"default":"outline",onClick:()=>{F("file"),U.current&&U.current.click()},className:"gap-2",children:[s.jsx(t,{size:16,weight:"fill"}),s.jsx("span",{children:"Upload"})]})}),s.jsx(f,{style:I.animatedStyle,onMouseEnter:I.handleMouseEnter,onMouseLeave:I.handleMouseLeave,onClick:I.handlePress,children:s.jsxs(y,{type:"button",size:"sm",variant:"url"===E?"default":"outline",onClick:()=>F("url"),className:"gap-2",children:[s.jsx(l,{size:16,weight:"fill"}),s.jsx("span",{children:"URL"})]})})]}),s.jsx("input",{ref:T,type:"file",accept:"image/*",capture:"environment",onChange:e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];a&&K(a)},className:"hidden","aria-label":"Take photo with camera"}),s.jsx("input",{ref:U,type:"file",accept:"image/*",onChange:e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];a&&K(a)},className:"hidden","aria-label":"Upload photo from device"}),"url"===E&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:C,onChange:e=>{return s=e.target.value,S(s),L(null),void R(!1);var s},placeholder:"Paste image URL here...","aria-label":"Image URL",className:"flex-1 px-3 py-2 text-sm border border-input rounded-md bg-background focus:border-ring focus:outline-none focus:ring-2 focus:ring-ring/20 transition-all",disabled:k}),s.jsx(y,{type:"button",onClick:q,disabled:!C||k,className:"bg-linear-to-r from-primary to-accent hover:opacity-90",children:k?s.jsxs(s.Fragment,{children:[s.jsx(f,{style:W,children:s.jsx(a,{size:18,weight:"fill"})}),s.jsx("span",{className:"ml-2",children:"Analyzing..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(r,{size:18,weight:"fill"}),s.jsx("span",{className:"ml-2",children:"Analyze"})]})})]}),("file"===E||"camera"===E)&&C&&s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"flex-1 px-3 py-2 text-sm border border-input rounded-md bg-muted text-muted-foreground",children:["Photo ","camera"===E?"captured":"uploaded"," âœ“"]}),s.jsx(y,{type:"button",onClick:q,disabled:k,className:"bg-linear-to-r from-primary to-accent hover:opacity-90",children:k?s.jsxs(s.Fragment,{children:[s.jsx(f,{style:W,children:s.jsx(a,{size:18,weight:"fill"})}),s.jsx("span",{className:"ml-2",children:"Analyzing..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(a,{size:18,weight:"fill"}),s.jsx("span",{className:"ml-2",children:"Analyze"})]})})]})]})]})})}),G.shouldRender&&C&&!k&&s.jsx(f,{style:G.animatedStyle,className:"relative h-64 rounded-lg overflow-hidden bg-muted",children:s.jsx("img",{src:C,alt:"Pet preview",className:"w-full h-full object-cover"})}),J.shouldRender&&k&&s.jsx(f,{style:J.animatedStyle,children:s.jsxs(g,{className:"p-6 bg-linear-to-br from-background to-muted/30",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(f,{style:W,children:s.jsx(a,{size:24,weight:"fill",className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:"Analyzing photo..."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"This may take a few seconds"})]})]}),s.jsx("div",{className:"space-y-3",children:["Detecting breed...","Estimating age...","Analyzing personality...","Calculating confidence..."].map(e=>s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),e]},e))})]})}),Q.shouldRender&&P&&s.jsx(f,{style:Q.animatedStyle,children:s.jsxs(g,{className:"p-6 bg-linear-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 border-green-200 dark:border-green-800",children:[s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center shrink-0",children:s.jsx(i,{size:24,weight:"bold",className:"text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-lg mb-1",children:"Analysis Complete!"}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx("span",{children:"Confidence:"}),s.jsxs(j,{variant:"secondary",className:"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300",children:[P.confidence,"%"]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Breed"}),s.jsx("div",{className:"font-semibold",children:P.breed})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Age"}),s.jsxs("div",{className:"font-semibold",children:[P.age," years"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Size"}),s.jsx("div",{className:"font-semibold capitalize",children:P.size.replace("-"," ")})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Traits"}),s.jsxs("div",{className:"font-semibold",children:[P.personality&&Array.isArray(P.personality)?P.personality.length:0," ","detected"]})]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Personality Traits"}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:P.personality.map(e=>s.jsx(j,{className:"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 border-green-200 dark:border-green-800",children:e},e))})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(y,{variant:"outline",className:"flex-1",onClick:()=>{R(!1),L(null)},children:[s.jsx(n,{size:18,weight:"bold"}),s.jsx("span",{className:"ml-2",children:"Discard"})]}),s.jsxs(y,{className:"flex-1 bg-linear-to-r from-green-500 to-emerald-500 hover:opacity-90",onClick:()=>{P&&(z({...P,photo:C}),o.success("Information applied!",{description:"You can still edit any field before saving"}))},children:[s.jsx(i,{size:18,weight:"bold"}),s.jsx("span",{className:"ml-2",children:"Apply to Profile"})]})]})]})})]})}export{k as default};
