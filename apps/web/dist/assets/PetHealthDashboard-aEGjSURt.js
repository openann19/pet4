import{r as e,am as s,j as t,an as a,cZ as i,ah as r,a3 as n,W as d,c9 as c,aj as l,cJ as o,aK as m,c_ as x}from"./react-vendor-atdIga2R.js";import{E as u,aq as h,a2 as p,f as j,N as g,Q as f,U as y,A as N,d as w,C as v,q as D,r as b,n as k,B as S,ad as I,ae as C,af as z,ag as R,s as M,F as T,av as V}from"./feature-admin-g8AIjMAb.js";import{p as E,q as A,i as F}from"./utils-vendor-7mYxNw04.js";import"./vendor-B2U5onNE.js";import"./ui-vendor-CttiZxwU.js";import"./feature-adoption-C919WvgL.js";import"./feature-community-DxZ7YsOF.js";const $=j("PetHealthDashboard");function O({vaccination:e,index:s}){const a=V({index:s,staggerDelay:50});return t.jsxs(N,{style:a.itemStyle,className:"flex items-start gap-3 p-4 rounded-lg border bg-card hover:shadow-md transition-shadow",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:t.jsx(c,{size:20,className:"text-primary"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-semibold",children:e.name}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[F(new Date(e.date),"MMM dd, yyyy")," • ",e.veterinarian]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:e.clinic}),e.nextDueDate&&t.jsxs(S,{variant:"outline",className:"mt-2",children:["Next: ",F(new Date(e.nextDueDate),"MMM dd, yyyy")]})]})]})}function P({record:e,index:s}){const a=V({index:s,staggerDelay:50});return t.jsxs(N,{style:a.itemStyle,className:"p-4 rounded-lg border bg-card hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsx("h4",{className:"font-semibold",children:e.title}),t.jsx(S,{variant:"outline",children:e.type})]}),t.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[F(new Date(e.date),"MMM dd, yyyy"),e.veterinarian&&` • ${e.veterinarian}`]}),t.jsx("p",{className:"text-sm",children:e.description}),e.diagnosis&&t.jsxs("p",{className:"text-sm mt-2",children:[t.jsx("span",{className:"font-medium",children:"Diagnosis:"})," ",e.diagnosis]})]})}function H({reminder:e,index:s,onComplete:i}){const n=V({index:s,staggerDelay:50}),d=A(new Date(e.dueDate)),c=E(new Date(e.dueDate),new Date);return t.jsxs(N,{style:n.itemStyle,className:"flex items-start gap-3 p-4 rounded-lg border bg-card hover:shadow-md transition-shadow "+(e.completed?"opacity-50":""),children:[t.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center shrink-0 "+(e.completed?"bg-green-100 dark:bg-green-900/20":d?"bg-red-100 dark:bg-red-900/20":"bg-yellow-100 dark:bg-yellow-900/20"),children:e.completed?t.jsx(r,{size:20,className:"text-green-600",weight:"fill"}):d?t.jsx(a,{size:20,className:"text-red-600",weight:"fill"}):t.jsx(o,{size:20,className:"text-yellow-600"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-semibold",children:e.title}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[F(new Date(e.dueDate),"MMM dd, yyyy"),!e.completed&&(d?` • ${Math.abs(c)} days overdue`:0===c?" • Due today":` • ${c} days away`)]}),e.description&&t.jsx("p",{className:"text-sm mt-1",children:e.description})]}),!e.completed&&t.jsx(w,{size:"sm",variant:"outline",onClick:()=>i(e.id),children:"Complete"})]})}function q({pet:j,onClose:V}){const[q,U]=u(`vaccinations-${j.id}`,[]),[B,J]=u(`health-records-${j.id}`,[]),[K,L]=u(`reminders-${j.id}`,[]),[Q,W]=e.useState(null),[Z,_]=e.useState(!0),G=h({isVisible:Z,duration:300}),X=e.useCallback(()=>{_(!1),setTimeout(()=>{V()},300)},[V]),Y=p({onPress:X,hapticFeedback:!0});e.useEffect(()=>(_(!0),()=>{_(!1)}),[]);const ee=e.useCallback(()=>{try{const e=new Date,s=(q||[]).filter(s=>{if(!s.nextDueDate)return!1;const t=new Date(s.nextDueDate);if(isNaN(t.getTime()))return!1;const a=new Date(e);if(isNaN(a.getTime()))return!1;const i=E(t,a);return i>=0&&i<=90}),t=(K||[]).filter(e=>!e.completed),a=(B||[]).sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()).slice(0,5),i=(B||[]).filter(e=>"checkup"===e.type)[0],r=null==i?void 0:i.date,n=s.filter(e=>Boolean(e.nextDueDate&&A(new Date(e.nextDueDate)))),d=s.filter(e=>{if(!e.nextDueDate)return!1;const s=E(new Date(e.nextDueDate),new Date);return s>=0&&s<=30}),c=n.length>0?"overdue":d.length>0?"due-soon":"up-to-date",l={petId:j.id,upcomingVaccinations:s,activeReminders:t,recentRecords:a,vaccinationStatus:c};void 0!==r&&(l.lastCheckup=r),W(l)}catch(e){const t=e instanceof Error?e:new Error(String(e));$.error("Failed to generate health summary",t,{petId:j.id}),s.error("Failed to load health summary",{description:"Please try again later"})}},[q,B,K,j.id]);e.useEffect(()=>{ee()},[ee]);const se=e.useCallback(e=>{switch(e){case"up-to-date":return"text-green-600 bg-green-100 dark:bg-green-900/20";case"due-soon":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/20";case"overdue":return"text-red-600 bg-red-100 dark:bg-red-900/20"}},[]),te=e.useCallback(e=>{switch(e){case"up-to-date":return t.jsx(r,{size:20,weight:"fill"});case"due-soon":return t.jsx(i,{size:20,weight:"fill"});case"overdue":return t.jsx(a,{size:20,weight:"fill"})}},[]),ae=e.useCallback(e=>{switch(e){case"up-to-date":return"Up to Date";case"due-soon":return"Due Soon";case"overdue":return"Overdue"}},[]),ie=e.useCallback(()=>{try{const e={id:`vac-${Date.now()}`,petId:j.id,type:"rabies",name:"Rabies Vaccination",date:(new Date).toISOString().split("T")[0]??"",veterinarian:"Dr. Smith",clinic:"Happy Paws Veterinary",createdAt:(new Date).toISOString()};U(s=>[...s||[],e]),s.success("Vaccination added",{description:"Vaccination record created successfully"}),$.info("Vaccination added",{petId:j.id,vaccinationId:e.id})}catch(e){const t=e instanceof Error?e:new Error(String(e));$.error("Failed to add vaccination",t,{petId:j.id}),s.error("Failed to add vaccination",{description:"Please try again"})}},[j.id,U]),re=e.useCallback(()=>{try{const e={id:`health-${Date.now()}`,petId:j.id,type:"checkup",title:"Annual Checkup",date:(new Date).toISOString().split("T")[0]??"",description:"Routine annual health examination",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};J(s=>[...s||[],e]),s.success("Health record added",{description:"Health record created successfully"}),$.info("Health record added",{petId:j.id,recordId:e.id})}catch(e){const t=e instanceof Error?e:new Error(String(e));$.error("Failed to add health record",t,{petId:j.id}),s.error("Failed to add health record",{description:"Please try again"})}},[j.id,J]),ne=e.useCallback(()=>{try{const e={id:`rem-${Date.now()}`,petId:j.id,type:"vaccination",title:"Vaccination Due",dueDate:new Date(Date.now()+2592e6).toISOString().split("T")[0]??"",completed:!1,notificationsSent:0,createdAt:(new Date).toISOString()};L(s=>[...s||[],e]),s.success("Reminder added",{description:"Reminder created successfully"}),$.info("Reminder added",{petId:j.id,reminderId:e.id})}catch(e){const t=e instanceof Error?e:new Error(String(e));$.error("Failed to add reminder",t,{petId:j.id}),s.error("Failed to add reminder",{description:"Please try again"})}},[j.id,L]),de=e.useCallback(e=>{try{L(s=>(s||[]).map(s=>s.id===e?{...s,completed:!0,completedAt:(new Date).toISOString()}:s)),s.success("Reminder completed",{description:"Reminder marked as complete"}),$.info("Reminder completed",{petId:j.id,reminderId:e})}catch(t){const a=t instanceof Error?t:new Error(String(t));$.error("Failed to complete reminder",a,{petId:j.id,reminderId:e}),s.error("Failed to complete reminder",{description:"Please try again"})}},[j.id,L]),ce=e.useMemo(()=>(q||[]).sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()),[q]),le=e.useMemo(()=>(B||[]).sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()),[B]),oe=e.useMemo(()=>(K||[]).sort((e,s)=>new Date(e.dueDate).getTime()-new Date(s.dueDate).getTime()),[K]),me=g(0);e.useEffect(()=>{me.value=f(1)},[me]);const xe=y(()=>({opacity:me.value}));return t.jsx(N,{style:xe,className:"fixed inset-0 bg-background/95 backdrop-blur-sm z-50 overflow-auto",children:t.jsxs(N,{style:G.style,className:"max-w-5xl mx-auto p-4 sm:p-6 lg:p-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center",children:t.jsx(n,{size:24,className:"text-white",weight:"fill"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Health Dashboard"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:[j.name,"'s health records"]})]})]}),t.jsx(N,{style:Y.animatedStyle,children:t.jsx(w,{variant:"ghost",size:"icon",onClick:Y.handlePress,children:t.jsx(d,{size:24})})})]}),Q&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs(v,{children:[t.jsx(D,{className:"pb-3",children:t.jsxs(b,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(c,{size:16}),"Vaccination Status"]})}),t.jsxs(k,{children:[t.jsxs(S,{className:`${se(Q.vaccinationStatus)} flex items-center gap-1 w-fit`,children:[te(Q.vaccinationStatus),ae(Q.vaccinationStatus)]}),Q.upcomingVaccinations.length>0&&t.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[Q.upcomingVaccinations.length," upcoming"]})]})]}),t.jsxs(v,{children:[t.jsx(D,{className:"pb-3",children:t.jsxs(b,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(l,{size:16}),"Last Checkup"]})}),t.jsx(k,{children:Q.lastCheckup?t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-semibold",children:F(new Date(Q.lastCheckup),"MMM dd, yyyy")}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[E(new Date,new Date(Q.lastCheckup))," days ago"]})]}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"No checkups recorded"})})]}),t.jsxs(v,{children:[t.jsx(D,{className:"pb-3",children:t.jsxs(b,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(o,{size:16}),"Active Reminders"]})}),t.jsxs(k,{children:[t.jsx("p",{className:"text-2xl font-bold",children:Q.activeReminders.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:0===Q.activeReminders.length?"All caught up!":"pending tasks"})]})]})]}),t.jsxs(I,{defaultValue:"vaccinations",className:"w-full",children:[t.jsxs(C,{className:"grid w-full grid-cols-3",children:[t.jsx(z,{value:"vaccinations",children:"Vaccinations"}),t.jsx(z,{value:"records",children:"Health Records"}),t.jsx(z,{value:"reminders",children:"Reminders"})]}),t.jsx(R,{value:"vaccinations",className:"mt-4",children:t.jsxs(v,{children:[t.jsx(D,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(b,{children:"Vaccination Records"}),t.jsx(M,{children:"Track all vaccination history"})]}),t.jsxs(w,{onClick:ie,size:"sm",children:[t.jsx(m,{size:16,className:"mr-2"}),"Add Vaccination"]})]})}),t.jsx(k,{children:t.jsx(T,{className:"h-[400px]",children:0===ce.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(c,{size:48,className:"mx-auto text-muted-foreground mb-3"}),t.jsx("p",{className:"text-muted-foreground",children:"No vaccination records yet"})]}):t.jsx("div",{className:"space-y-3",children:ce.map((e,s)=>t.jsx(O,{vaccination:e,index:s},e.id))})})})]})}),t.jsx(R,{value:"records",className:"mt-4",children:t.jsxs(v,{children:[t.jsx(D,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(b,{children:"Health Records"}),t.jsx(M,{children:"All medical history and visits"})]}),t.jsxs(w,{onClick:re,size:"sm",children:[t.jsx(m,{size:16,className:"mr-2"}),"Add Record"]})]})}),t.jsx(k,{children:t.jsx(T,{className:"h-[400px]",children:0===le.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(x,{size:48,className:"mx-auto text-muted-foreground mb-3"}),t.jsx("p",{className:"text-muted-foreground",children:"No health records yet"})]}):t.jsx("div",{className:"space-y-3",children:le.map((e,s)=>t.jsx(P,{record:e,index:s},e.id))})})})]})}),t.jsx(R,{value:"reminders",className:"mt-4",children:t.jsxs(v,{children:[t.jsx(D,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(b,{children:"Reminders"}),t.jsx(M,{children:"Upcoming appointments and tasks"})]}),t.jsxs(w,{onClick:ne,size:"sm",children:[t.jsx(m,{size:16,className:"mr-2"}),"Add Reminder"]})]})}),t.jsx(k,{children:t.jsx(T,{className:"h-[400px]",children:0===oe.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(o,{size:48,className:"mx-auto text-muted-foreground mb-3"}),t.jsx("p",{className:"text-muted-foreground",children:"No reminders set"})]}):t.jsx("div",{className:"space-y-3",children:oe.map((e,s)=>t.jsx(H,{reminder:e,index:s,onComplete:de},e.id))})})})]})})]})]})})}export{q as PetHealthDashboard,q as default};
