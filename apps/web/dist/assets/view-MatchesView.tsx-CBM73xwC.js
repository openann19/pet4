import{a3 as e,a1 as s,aP as a,ag as t,j as l,aG as r,bY as n,r as i,W as o,al as c,U as d,ac as u,aj as m,a7 as x,bQ as h,ch as g,Z as p,aF as f,aA as b}from"./react-vendor-atdIga2R.js";import{q as j,p as v,m as y,u as N,C as w}from"./view-ChatView.tsx-DI-Ea8ls.js";import{g as C,c as k,C as S,a as P}from"./view-DiscoverView.tsx-yydAwB0u.js";import{K as z,C as M,q as A,r as R,n as T,B as E,P as I,N as V,Q as D,U as L,M as F,h as $,O as q,A as B,F as Y,a2 as X,d as _,ad as O,ae as W,af as G,ag as K,$ as U,u as Q,a as H,m as Z,V as J,W as ee,D as se,g as ae}from"./feature-admin-g8AIjMAb.js";import{o as te}from"./feature-community-DxZ7YsOF.js";import{P as le}from"./view-AdoptionView.tsx-BJlxubb2.js";function re({pet:i,trustProfile:o,compatibilityScore:c,matchReasons:d}){var u;z();const m=[{icon:e,label:"Overall Rating",value:(null==(u=null==o?void 0:o.overallRating)?void 0:u.toFixed(1))||"N/A",max:"5.0",color:"text-primary",bgColor:"bg-primary/10",borderColor:"border-primary/20"},{icon:s,label:"Playdates",value:(null==o?void 0:o.playdateCount)||0,suffix:" completed",color:"text-secondary",bgColor:"bg-secondary/10",borderColor:"border-secondary/20"},{icon:a,label:"Response Rate",value:`${Math.round(100*((null==o?void 0:o.responseRate)||0))}%`,color:"text-accent",bgColor:"bg-accent/10",borderColor:"border-accent/20"},{icon:t,label:"Avg Response",value:(null==o?void 0:o.responseTime)||"N/A",color:"text-lavender",bgColor:"bg-lavender/10",borderColor:"border-lavender/20"}],x=i.personality||[],h=i.interests||[];return l.jsxs("div",{className:"space-y-6",children:[void 0!==c&&l.jsx(ne,{children:l.jsxs(M,{className:"border-primary/20 bg-linear-to-br from-primary/5 to-accent/5",children:[l.jsx(A,{children:l.jsxs(R,{className:"flex items-center gap-2",children:[l.jsx(r,{size:24,className:"text-primary",weight:"duotone"}),"Compatibility Score"]})}),l.jsxs(T,{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"text-5xl font-bold bg-linear-to-r from-primary to-accent bg-clip-text text-transparent",children:[c,"%"]}),l.jsx(E,{variant:c>=85?"default":c>=70?"secondary":"outline",className:"text-sm px-3 py-1",children:c>=85?"Perfect Match":c>=70?"Great Fit":c>=55?"Good Potential":"Worth Exploring"})]}),l.jsx(I,{value:c,className:"h-3"}),d&&d.length>0&&l.jsxs("div",{className:"space-y-2 mt-4",children:[l.jsx("p",{className:"text-sm font-semibold text-muted-foreground",children:"Why this match works:"}),l.jsx("ul",{className:"space-y-1.5",children:d.map((e,s)=>l.jsx(ie,{index:s,children:l.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[l.jsx(n,{size:16,className:"text-accent mt-0.5 shrink-0",weight:"fill"}),l.jsx("span",{children:e})]})},s))})]})]})]})}),l.jsx(ne,{children:l.jsxs(M,{children:[l.jsx(A,{children:l.jsx(R,{children:"Social Stats"})}),l.jsx(T,{children:l.jsx("div",{className:"grid grid-cols-2 gap-4",children:m.map((e,s)=>l.jsx(oe,{index:s,children:l.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-xl ${e.bgColor} border ${e.borderColor}`,children:[l.jsx("div",{className:`p-2 rounded-lg ${e.bgColor}`,children:l.jsx(e.icon,{size:24,className:e.color,weight:"duotone"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-xs text-muted-foreground truncate",children:e.label}),l.jsxs("p",{className:`text-lg font-bold ${e.color} truncate`,children:[e.value,e.suffix&&l.jsx("span",{className:"text-xs font-normal",children:e.suffix})]})]})]})},s))})})]})}),o&&o.totalReviews>0&&l.jsx(ne,{children:l.jsxs(M,{children:[l.jsx(A,{children:l.jsx(R,{children:"Rating Distribution"})}),l.jsx(T,{className:"space-y-3",children:[5,4,3,2,1].map(e=>{var s;const a=(null==(s=o.ratingBreakdown)?void 0:s[e])||0,t=o.totalReviews>0?a/o.totalReviews*100:0;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-1 w-16",children:[l.jsx("span",{className:"text-sm font-medium",children:e}),l.jsx(n,{size:14,className:"text-accent",weight:"fill"})]}),l.jsx("div",{className:"flex-1",children:l.jsx(I,{value:t,className:"h-2"})}),l.jsx("span",{className:"text-sm text-muted-foreground w-12 text-right",children:a})]},e)})})]})}),l.jsx(ne,{children:l.jsxs(M,{children:[l.jsx(A,{children:l.jsx(R,{children:"Personality & Interests"})}),l.jsxs(T,{className:"space-y-4",children:[x.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"Personality"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:x.map((e,s)=>l.jsx(ce,{index:s,children:l.jsx(E,{variant:"secondary",className:"text-sm",children:e})},s))})]}),h.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-semibold text-muted-foreground mb-2",children:"Interests"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:h.map((e,s)=>l.jsx(ce,{index:s,children:l.jsx(E,{variant:"outline",className:"text-sm",children:e})},s))})]})]})]})})]})}function ne({children:e}){const s=V(0),a=V(20);i.useEffect(()=>{s.value=D(1),a.value=D(0)},[s,a]);const t=L(()=>({opacity:s.value,transform:[{translateY:a.value}]}));return l.jsx(F,{animatedStyle:t,children:e})}function ie({index:e,children:s}){const a=V(0),t=V(-10);i.useEffect(()=>{setTimeout(()=>{a.value=D(1),t.value=D(0)},100*e)},[e,a,t]);const r=L(()=>({opacity:a.value,transform:[{translateX:t.value}]}));return l.jsx(F,{animatedStyle:r,children:s})}function oe({index:e,children:s}){const a=V(0),t=V(.9);i.useEffect(()=>{setTimeout(()=>{a.value=D(1),t.value=D(1)},50*e)},[e,a,t]);const r=L(()=>({opacity:a.value,transform:[{scale:t.value}]}));return l.jsx(F,{animatedStyle:r,children:s})}function ce({index:e,children:s}){const a=V(0),t=V(.8);i.useEffect(()=>{setTimeout(()=>{a.value=D(1),t.value=D(1)},50*e)},[e,a,t]);const r=L(()=>({opacity:a.value,transform:[{scale:t.value}]}));return l.jsx(F,{animatedStyle:r,children:s})}function de({pet:e,onClose:s,onLike:a,onPass:t,onChat:r,compatibilityScore:n,matchReasons:o,showActions:c=!0}){z();const[d,u]=i.useState(0),[m,x]=i.useState(!0),[h,g]=i.useState(!0),p=e.photos&&e.photos.length>0?e.photos:[e.photo],f=i.useCallback(()=>{g(!1),setTimeout(()=>{s()},200)},[s]),b=i.useCallback(()=>{x(!0),u(e=>(e+1)%p.length),$.trigger("light")},[p.length]),j=i.useCallback(()=>{x(!0),u(e=>(e-1+p.length)%p.length),$.trigger("light")},[p.length]),v=function(e={}){const{onSwipeLeft:s,onSwipeRight:a,threshold:t=50,preventDefault:l=!0}=e,[r,n]=i.useState(!1),[o,c]=i.useState(0),d=i.useRef(null),u=i.useRef(null),m=i.useRef(null),x=i.useCallback((e,s)=>{d.current=e,u.current=s,n(!0),c(0)},[]),h=i.useCallback((e,s)=>{if(null===d.current||null===u.current)return;const a=e-d.current,t=s-u.current;Math.abs(a)>Math.abs(t)&&c(a)},[]),g=i.useCallback(e=>{if(null===d.current)return;const l=e-d.current;Math.abs(l)>=t&&(l>0&&a?a():l<0&&s&&s()),d.current=null,u.current=null,n(!1),c(0)},[t,s,a]);return{handlers:{onTouchStart:i.useCallback(e=>{l&&e.preventDefault();const s=e.touches[0];s&&x(s.clientX,s.clientY)},[x,l]),onTouchMove:i.useCallback(e=>{l&&e.preventDefault();const s=e.touches[0];s&&h(s.clientX,s.clientY)},[h,l]),onTouchEnd:i.useCallback(e=>{l&&e.preventDefault();const s=e.changedTouches[0];s&&g(s.clientX)},[g,l]),onMouseDown:i.useCallback(e=>{l&&e.preventDefault(),x(e.clientX,e.clientY)},[x,l]),onMouseMove:i.useCallback(e=>{l&&e.preventDefault(),null!==d.current&&h(e.clientX,e.clientY)},[h,l]),onMouseUp:i.useCallback(e=>{l&&e.preventDefault(),null!==d.current&&g(e.clientX)},[g,l])},isSwiping:r,swipeDistance:o,ref:m}}({onSwipeLeft:b,onSwipeRight:j,threshold:50}),y=i.useCallback(()=>{x(!1)},[]),N=i.useCallback(()=>{x(!1)},[]),w=i.useCallback(()=>{$.trigger("medium"),null==a||a()},[a]),C=i.useCallback(()=>{$.trigger("light"),null==t||t()},[t]),k=i.useCallback(()=>{$.trigger("light"),null==r||r()},[r]),S=e.trustScore??0,P=i.useCallback(e=>e>=80?{label:"Highly Trusted",color:"text-green-500"}:e>=60?{label:"Trusted",color:"text-blue-500"}:e>=40?{label:"Established",color:"text-yellow-500"}:{label:"New",color:"text-muted-foreground"},[])(S),M=V(0),A=V(.95),R=V(0),T=V(.95),E=V(0);i.useEffect(()=>{h?(M.value=q(1),A.value=q(1),R.value=q(1),T.value=q(1)):(M.value=q(0),T.value=q(.95))},[h]),i.useEffect(()=>{E.value=q(1)},[d]);const I=L(()=>({opacity:M.value})),D=L(()=>({opacity:R.value,transform:[{scale:T.value}]})),F=L(()=>({opacity:E.value}));return l.jsx(B,{className:"fixed inset-0 bg-background/95 backdrop-blur-xl z-50 flex items-center justify-center p-4",onClick:f,style:I,children:l.jsx(B,{className:"w-full max-w-4xl max-h-[90vh] bg-card rounded-3xl shadow-2xl overflow-hidden",onClick:e=>e.stopPropagation(),style:D,children:l.jsxs("div",{className:"relative h-full flex flex-col",children:[l.jsx("div",{className:"absolute top-4 right-4 z-10",children:l.jsx(ue,{onClose:f})}),l.jsxs(Y,{className:"flex-1",children:[l.jsxs("div",{className:"relative h-96 bg-muted overflow-hidden",...v.handlers,children:[m&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:l.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"})}),l.jsx(B,{className:"w-full h-full",style:F,children:l.jsx("img",{src:p[d],alt:e.name,className:"w-full h-full object-cover",onLoad:y,onError:N})},d),p.length>1&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-4 pointer-events-none",children:[l.jsx(me,{onClick:j}),l.jsx(me,{onClick:b})]}),l.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2",children:p.map((e,s)=>l.jsx(xe,{index:s,isActive:s===d,onClick:()=>{x(!0),u(s)}},s))})]}),void 0!==n&&l.jsx(he,{score:n})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsx(ge,{pet:e,trustScore:S,trustLevel:P}),o&&o.length>0&&l.jsx(pe,{reasons:o}),l.jsx(be,{pet:e})]})]}),c&&l.jsx(Ne,{onLike:a?w:void 0,onPass:t?C:void 0,onChat:r?k:void 0})]})})})}function ue({onClose:e}){const s=X(),a=i.useCallback(()=>{$.trigger("light"),e()},[e]);return l.jsx(_,{variant:"ghost",size:"icon",onClick:a,className:"rounded-full bg-background/80 backdrop-blur-sm hover:bg-background","aria-label":"Close pet detail view",children:l.jsx(B,{style:s.animatedStyle,children:l.jsx(o,{size:24,weight:"bold"})})})}function me({onClick:e}){const s=X(),a=i.useCallback(()=>{$.trigger("light"),e()},[e]);return l.jsx(_,{variant:"ghost",size:"icon",onClick:a,className:"rounded-full bg-background/80 backdrop-blur-sm hover:bg-background pointer-events-auto","aria-label":"Navigate to next photo",children:l.jsx(B,{style:s.animatedStyle,children:l.jsx(c,{size:20,weight:"fill"})})})}function xe({index:e,isActive:s,onClick:a}){return l.jsx("button",{onClick:a,className:"h-2 rounded-full transition-all overflow-hidden "+(s?"w-6 bg-white":"w-2 bg-white/50"),"aria-label":`Go to photo ${e+1}`,children:l.jsx(B,{className:"h-full rounded-full bg-white",style:L(()=>({width:s?24:8,opacity:s?1:.5}))})})}function he({score:e}){const s=V(0),a=V(.8);i.useEffect(()=>{s.value=q(1),a.value=q(1)},[]);const t=L(()=>({opacity:s.value,transform:[{scale:a.value}]}));return l.jsx("div",{className:"absolute top-4 left-4",children:l.jsxs(B,{className:"flex items-center gap-2 px-4 py-2 rounded-full bg-linear-to-r from-primary to-accent backdrop-blur-sm",style:t,children:[l.jsx(r,{size:20,weight:"bold",className:"text-white"}),l.jsxs("span",{className:"text-lg font-bold text-white",children:[e,"% Match"]})]})})}function ge({pet:e,trustScore:s,trustLevel:a}){return l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold",children:e.name}),l.jsxs("p",{className:"text-lg text-muted-foreground",children:[e.breed," • ",e.age," ",1===e.age?"year":"years"]})]}),s>0&&l.jsxs("div",{className:"flex flex-col items-end gap-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(d,{size:20,className:a.color,weight:"fill"}),l.jsx("span",{className:`font-semibold ${a.color}`,children:a.label})]}),l.jsxs("span",{className:"text-sm text-muted-foreground",children:["Trust Score: ",s]})]})]}),l.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[l.jsx(u,{size:16,weight:"fill"}),l.jsx("span",{children:e.location})]})]})}function pe({reasons:e}){return l.jsx(M,{className:"border-primary/20 bg-linear-to-br from-primary/5 to-accent/5",children:l.jsxs(T,{className:"p-4 space-y-2",children:[l.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[l.jsx(n,{size:20,className:"text-accent",weight:"fill"}),"Why This Match Works"]}),l.jsx("ul",{className:"space-y-1.5",children:e.map((e,s)=>l.jsx(fe,{reason:e,index:s},s))})]})})}function fe({reason:s,index:a}){const t=V(0),r=V(-10);i.useEffect(()=>{t.value=U(50*a,q(1)),r.value=U(50*a,q(0))},[a]);const n=L(()=>({opacity:t.value,transform:[{translateX:r.value}]}));return l.jsxs(B,{className:"text-sm flex items-start gap-2",style:n,children:[l.jsx(e,{size:14,className:"text-primary mt-0.5 shrink-0",weight:"fill"}),l.jsx("span",{children:s})]})}function be({pet:e}){var t;return l.jsxs(O,{defaultValue:"about",className:"w-full",children:[l.jsxs(W,{className:"grid w-full grid-cols-3",children:[l.jsx(G,{value:"about",children:"About"}),l.jsx(G,{value:"personality",children:"Personality"}),l.jsx(G,{value:"stats",children:"Stats"})]}),l.jsxs(K,{value:"about",className:"space-y-4 mt-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Bio"}),l.jsx("p",{className:"text-muted-foreground",children:e.bio})]}),e.interests&&e.interests.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Interests"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:e.interests.map((e,s)=>l.jsx(E,{variant:"secondary",children:e},s))})]}),e.lookingFor&&e.lookingFor.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Looking For"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:e.lookingFor.map((e,s)=>l.jsx(E,{variant:"outline",children:e},s))})]})]}),l.jsxs(K,{value:"personality",className:"space-y-4 mt-4",children:[e.personality&&e.personality.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-3",children:"Personality Traits"}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:e.personality.map((e,s)=>l.jsx(je,{trait:e,index:s},s))})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-2",children:"Activity Level"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{children:"Energy"}),l.jsx("span",{className:"font-medium",children:e.activityLevel??"Moderate"})]}),l.jsx(I,{value:75,className:"h-2"})]})]})]}),l.jsxs(K,{value:"stats",className:"space-y-4 mt-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsx(ve,{icon:s,label:"Playdates",value:String(e.playdateCount??0),color:"primary"}),l.jsx(ve,{icon:n,label:"Rating",value:(null==(t=e.overallRating)?void 0:t.toFixed(1))??"N/A",color:"accent"}),l.jsx(ve,{icon:a,label:"Response Rate",value:`${Math.round(100*(e.responseRate??0))}%`,color:"secondary"}),l.jsx(ve,{icon:m,label:"Member Since",value:String(new Date(e.createdAt??Date.now()).getFullYear()),color:"lavender"})]}),e.badges&&e.badges.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold mb-3",children:"Trust Badges"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:e.badges.map((e,s)=>l.jsx(ye,{badge:e,index:s},s))})]})]})]})}function je({trait:e,index:s}){const a=V(0),t=V(.9);i.useEffect(()=>{a.value=U(50*s,q(1)),t.value=U(50*s,q(1))},[s]);const r=L(()=>({opacity:a.value,transform:[{scale:t.value}]}));return l.jsxs(B,{className:"p-3 rounded-lg bg-muted/50 border border-border text-center",style:r,children:[l.jsx(c,{size:24,className:"text-primary mx-auto mb-1",weight:"fill"}),l.jsx("span",{className:"text-sm font-medium",children:e})]})}function ve({icon:e,label:s,value:a,color:t}){return l.jsx(M,{children:l.jsx(T,{className:"p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`p-2 rounded-lg ${{primary:"bg-primary/10 text-primary",accent:"bg-accent/10 text-accent",secondary:"bg-secondary/10 text-secondary",lavender:"bg-lavender/10 text-lavender"}[t]}`,children:l.jsx(e,{size:24,weight:"duotone"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:s}),l.jsx("p",{className:"text-2xl font-bold",children:a})]})]})})})}function ye({badge:e,index:s}){const a=V(0),t=V(.8);i.useEffect(()=>{a.value=U(50*s,q(1)),t.value=U(50*s,q(1))},[s]);const r=L(()=>({opacity:a.value,transform:[{scale:t.value}]}));return l.jsx(B,{style:r,children:l.jsxs(E,{className:"px-3 py-1.5",children:[l.jsx(d,{size:14,className:"mr-1",weight:"fill"}),e.label]})})}function Ne({onLike:s,onPass:a,onChat:t}){return l.jsx("div",{className:"border-t border-border p-4 bg-card/95 backdrop-blur-sm",children:l.jsxs("div",{className:"flex gap-3 max-w-md mx-auto",children:[a&&l.jsx(we,{variant:"outline",icon:o,label:"Pass",onClick:a}),t&&l.jsx(we,{variant:"secondary",icon:x,label:"Chat",onClick:t}),s&&l.jsx(we,{variant:"primary",icon:e,label:"Like",onClick:s,className:"bg-linear-to-r from-primary to-accent hover:opacity-90"})]})})}function we({variant:e,icon:s,label:a,onClick:t,className:r}){const n=X(),o=i.useCallback(()=>{$.trigger("light"),t()},[t]);return l.jsx(_,{variant:"outline"===e?"outline":"secondary"===e?"secondary":"default",size:"lg",onClick:o,className:`flex-1 rounded-full ${r??""}`,children:l.jsxs(B,{style:n.animatedStyle,className:"flex items-center",children:[l.jsx(s,{size:20,weight:"primary"===e?"fill":"bold",className:"mr-2"}),a]})})}const Ce=Object.freeze(Object.defineProperty({__proto__:null,EnhancedPetDetailView:de},Symbol.toStringTag,{value:"Module"}));function ke(e){var s;return{id:e.id,name:e.name,breed:e.breed,age:e.age,gender:e.gender,size:e.size,photo:(null==(s=e.photos[0])?void 0:s.url)||"",photos:e.photos.map(e=>e.url),bio:e.bio,personality:e.personality,interests:[],lookingFor:[],location:e.location.city||"",coordinates:{latitude:e.location.latitude,longitude:e.location.longitude},ownerId:e.ownerId,ownerName:"",verified:e.verified,createdAt:e.createdAt}}function Se(e){var s;const{data:a}=h({queryKey:[...j.pets.list,t],queryFn:async()=>(await v.list(t)).items,staleTime:3e5,gcTime:6e5});var t;const[l,r]=i.useState(null),[n,o]=i.useState(null),[c,d]=i.useState([]),u=Array.isArray(a)?a:[],m=u.length>0?null==(s=u[0])?void 0:s.id:void 0,{data:x=[],isLoading:p}=h({queryKey:m?[...j.matches.list,m]:j.matches.list,queryFn:()=>m?y.getMatches(m):Promise.resolve([]),enabled:!!m,staleTime:3e5,gcTime:6e5}),f=i.useMemo(()=>m&&Array.isArray(x)?x.map(e=>function(e,s){const a=e.petAId===s?e.petBId:e.petAId;return{id:e.id,petId:s,matchedPetId:a,compatibilityScore:e.compatibilityScore,reasoning:[],matchedAt:e.createdAt,status:e.status}}(e,m)):[],[x,m]),b=i.useMemo(()=>null==a?void 0:a.map(e=>ke(e)),[a]),N=i.useMemo(()=>{if(null==b?void 0:b.length)return b.find(e=>e.id===m)||b[0]},[b,m]),w=i.useMemo(()=>Array.isArray(f)&&m?Array.from(new Set(f.filter(e=>"active"===e.status).map(e=>e.petId===m?e.matchedPetId:e.petId).filter(e=>void 0!==e&&""!==e))):[],[f,m]),k=g({queries:w.map(e=>({queryKey:j.pets.detail(e),queryFn:async()=>ke(await v.getById(e)),enabled:!!e,staleTime:3e5,gcTime:6e5}))}),S=i.useMemo(()=>{if(!Array.isArray(f)||!m)return[];const e=new Map;return k.forEach(s=>{s.data&&e.set(s.data.id,s.data)}),f.filter(e=>"active"===e.status).map(s=>{const a=s.petId===m?s.matchedPetId:s.petId,t=a?e.get(a):void 0;return t?{...t,match:s}:null}).filter(e=>null!==e)},[f,m,k]),P=p||k.some(e=>e.isLoading);i.useEffect(()=>{l&&N&&n&&N.breed&&N.age&&N.size&&l.breed&&l.age&&l.size?C(N,l).then(d).catch(e=>{d([])}):d([])},[null==l?void 0:l.id,null==N?void 0:N.id,n]);return{matches:f,userPets:b,userPet:N,matchedPets:S,selectedPet:l,selectedMatch:n,matchReasoning:c,isLoading:P,selectPet:(e,s)=>{r(e),o(s)},clearSelection:()=>{r(null),o(null)}}}function Pe({pet:e,onSelect:s,onBreakdown:a,onPlaydate:t,onVideoCall:r,onChat:n,t:i}){return l.jsx(B,{children:l.jsxs("div",{className:"overflow-hidden rounded-3xl glass-strong premium-shadow backdrop-blur-2xl cursor-pointer group relative border border-white/20",children:[l.jsx(B,{className:"absolute inset-0 bg-gradient-to-br from-primary/10 via-transparent to-accent/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"}),l.jsxs("div",{className:"relative h-64 overflow-hidden",onClick:()=>{$.trigger("selection"),s()},children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/10 via-transparent to-accent/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500 z-10 pointer-events-none"}),l.jsx("img",{src:e.photo,alt:e.name,className:"w-full h-full object-cover"}),l.jsx(B,{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"}),l.jsx(B,{className:"absolute top-3 right-3 glass-strong px-3 py-1.5 rounded-full font-bold text-sm shadow-2xl border border-white/30 backdrop-blur-xl",children:l.jsxs("span",{className:"bg-gradient-to-r from-accent via-primary to-accent bg-clip-text text-transparent",children:[e.match.compatibilityScore,"%"]})}),l.jsx(B,{onClick:e=>{e.stopPropagation(),$.trigger("selection"),a()},className:"absolute bottom-3 right-3 w-11 h-11 glass-strong rounded-full flex items-center justify-center shadow-xl border border-white/30 backdrop-blur-xl",children:l.jsx(p,{size:20,className:"text-white drop-shadow-lg",weight:"bold"})})]}),l.jsxs("div",{className:"p-5 bg-gradient-to-br from-white/40 to-white/20 backdrop-blur-md",children:[l.jsxs("div",{className:"flex items-start justify-between mb-2 gap-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"text-lg font-bold truncate",children:e.name}),l.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 truncate",children:[l.jsx(u,{size:14,weight:"fill"}),e.location]})]}),l.jsx(ze,{onPlaydate:t,onVideoCall:r,onChat:n})]}),l.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[e.breed," • ",e.age," ",i.common.years]}),e.match.reasoning.length>0&&l.jsxs("div",{className:"pt-3 border-t border-border",children:[l.jsxs("p",{className:"text-xs font-semibold text-muted-foreground mb-1 flex items-center gap-1",children:[l.jsx(f,{size:12,weight:"fill",className:"text-accent"}),i.matches.whyMatched]}),l.jsx("p",{className:"text-sm text-foreground line-clamp-2",children:e.match.reasoning[0]})]})]})]})})}function ze({onPlaydate:e,onVideoCall:s,onChat:a}){return l.jsxs("div",{className:"flex items-center gap-1.5 shrink-0",children:[l.jsx(B,{onClick:s=>{s.stopPropagation(),$.trigger("selection"),e()},className:"w-10 h-10 rounded-full bg-gradient-to-br from-secondary to-primary flex items-center justify-center shadow-lg",title:"Schedule playdate",children:l.jsx(m,{size:18,weight:"fill",className:"text-white"})}),l.jsx(B,{onClick:e=>{e.stopPropagation(),$.trigger("medium"),s()},className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center shadow-lg",title:"Start video call",children:l.jsx(b,{size:18,weight:"fill",className:"text-white"})}),a&&l.jsx(B,{onClick:e=>{e.stopPropagation(),$.trigger("medium"),a()},className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center shadow-lg",title:"Start chat",children:l.jsx(x,{size:18,weight:"fill",className:"text-white"})})]})}const Me=Object.freeze(Object.defineProperty({__proto__:null,default:function({onNavigateToChat:s}){const{t:a}=Q(),{matchedPets:t,userPet:r,selectedPet:n,selectedMatch:o,matchReasoning:c,isLoading:d,selectPet:u,clearSelection:m}=Se(),[h,g]=i.useState(null),[p,f]=i.useState(null),{activeCall:b,initiateCall:j,endCall:v,toggleMute:y,toggleVideo:C}=N((null==n?void 0:n.id)||"room",(null==r?void 0:r.id)||"user",(null==r?void 0:r.name)||"You",null==r?void 0:r.photo),z=i.useCallback(e=>{u(e,e.match)},[u]),M=i.useCallback(e=>{g(e)},[]),A=i.useCallback(e=>{f(e)},[]),R=i.useCallback(e=>{j(e.id,e.name,e.photo,"video")},[j]),T=i.useCallback(()=>{$.trigger("medium"),null==s||s()},[s]),E=V(0),I=V(-180),F=V(1),Y=V(.5),X=V(0),U=V(20);H();const ne=Z({isVisible:0===t.length&&!d});Z({isVisible:!!n}),i.useEffect(()=>{0!==t.length||d||(E.value=q(1),I.value=q(0),X.value=D(1),U.value=q(0),F.value=J(ee(D(1.5),D(1))),Y.value=J(ee(D(0),D(.5))))},[t.length,d]);const ie=L(()=>({transform:[{scale:E.value},{rotate:`${I.value}deg`}]})),oe=L(()=>({transform:[{scale:F.value}],opacity:Y.value})),ce=L(()=>({opacity:X.value,transform:[{translateY:U.value}]}));return d?null:0===t.length?l.jsx(le,{direction:"up",children:l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:[ne.shouldRender&&l.jsxs(B,{style:[ie,ne.animatedStyle],className:"w-24 h-24 rounded-full bg-gradient-to-br from-primary/20 to-accent/20 flex items-center justify-center mb-6 relative",children:[l.jsx(B,{style:L(()=>({transform:[{scale:J(ee(D(1.2),D(1)))}]})),children:l.jsx(e,{size:48,className:"text-primary"})}),l.jsx(B,{style:oe,className:"absolute inset-0 rounded-full bg-gradient-to-br from-primary/20 to-accent/20"})]}),l.jsx(B,{style:ce,className:"text-2xl font-bold mb-2",children:a.matches.noMatches}),l.jsx(B,{style:ce,className:"text-muted-foreground mb-6 max-w-md",children:a.matches.noMatchesDesc})]})},"matches-empty"):l.jsx(le,{direction:"up",children:l.jsxs("div",{children:[l.jsxs("div",{className:"mb-6 flex items-center justify-between flex-wrap gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:a.matches.title}),l.jsxs("p",{className:"text-muted-foreground",children:[t.length," ",1===t.length?a.matches.subtitle:a.matches.subtitlePlural]})]}),s&&t.length>0&&l.jsx(B,{children:l.jsxs(_,{onClick:T,className:"bg-gradient-to-r from-primary to-accent hover:shadow-xl transition-all",size:"lg",children:[l.jsx(x,{size:20,weight:"fill",className:"mr-2"}),a.matches.startChat]})})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>l.jsx(Pe,{pet:e,onSelect:()=>z(e),onBreakdown:()=>M(e),onPlaydate:()=>A(e),onVideoCall:()=>R(e),onChat:s,t:a},e.id))}),l.jsx(B,{children:n&&o&&l.jsx(de,{pet:n,onClose:m,...s?{onChat:s}:{},compatibilityScore:o.compatibilityScore,matchReasons:c,showActions:!1})}),l.jsx(se,{open:!!h,onOpenChange:e=>!e&&g(null),children:l.jsx(ae,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:h&&r&&l.jsxs("div",{children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h3",{className:"text-2xl font-bold",children:h.name}),l.jsxs("p",{className:"text-muted-foreground",children:[a.matches.compatibilityWith," ",r.name]})]}),l.jsxs(O,{defaultValue:"analytics",className:"w-full",children:[l.jsxs(W,{className:"grid w-full grid-cols-2",children:[l.jsx(G,{value:"analytics",children:"Analytics"}),l.jsx(G,{value:"breakdown",children:"Breakdown"})]}),l.jsx(K,{value:"analytics",className:"mt-4",children:l.jsx(re,{pet:h,...h.trustProfile?{trustProfile:h.trustProfile}:{},compatibilityScore:k(r,h),matchReasons:h.match.reasoning||[]})}),l.jsx(K,{value:"breakdown",className:"mt-4",children:l.jsx(S,{factors:P(r,h)})})]})]})})}),p&&r&&l.jsx(i.Suspense,{fallback:l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}),children:l.jsx(te,{match:p.match,userPet:r,onClose:()=>f(null),onStartVideoCall:()=>{j(p.id,p.name,p.photo,"video"),f(null)},onStartVoiceCall:()=>{j(p.id,p.name,p.photo,"voice"),f(null)}})}),l.jsx(B,{children:b&&l.jsx(w,{session:b,onEndCall:v,onToggleMute:y,onToggleVideo:C})})]})},"matches-content")}},Symbol.toStringTag,{value:"Module"}));export{Ce as E,Me as M};
