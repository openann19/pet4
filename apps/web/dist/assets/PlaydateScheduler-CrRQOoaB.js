const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LocationPicker-DajWY9kP.js","assets/react-vendor-atdIga2R.js","assets/vendor-B2U5onNE.js","assets/utils-vendor-7mYxNw04.js","assets/ui-vendor-CttiZxwU.js","assets/feature-admin-g8AIjMAb.js","assets/feature-adoption-C919WvgL.js","assets/feature-community-DxZ7YsOF.js","assets/view-CommunityView.tsx-CD5NUxZ2.js","assets/view-AdoptionView.tsx-BJlxubb2.js"])))=>i.map(i=>d[i]);
import{b5 as e,h as s,f as a,M as t,d as i,ad as l,ae as r,af as n,ag as c,C as d,q as o,r as m,s as x,n as h,F as u,p,L as j,I as g,t as f,v as y,w as v,x as N,y as b,T as w,B as k,_ as C}from"./feature-admin-g8AIjMAb.js";import{r as S,am as T,j as z,aj as P,aA as I,ap as D,W as E,aK as L,ac as M,ab as F,at as O,ag as $,cg as A,aE as V,al as _,cX as q,cY as B}from"./react-vendor-atdIga2R.js";import{E as Y}from"./view-CommunityView.tsx-CD5NUxZ2.js";import{i as R,p as U,q as W}from"./utils-vendor-7mYxNw04.js";import"./feature-adoption-C919WvgL.js";import"./feature-community-DxZ7YsOF.js";import"./vendor-B2U5onNE.js";import"./ui-vendor-CttiZxwU.js";import"./view-AdoptionView.tsx-BJlxubb2.js";const G=a("PlaydateScheduler"),H=S.lazy(()=>C(()=>import("./LocationPicker-DajWY9kP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])));function K({match:a,userPet:C,onClose:K,onStartVideoCall:X,onStartVoiceCall:J}){const[Q,Z]=e("playdates",[]),[ee,se]=S.useState(!1),[ae,te]=S.useState(!1),[ie,le]=S.useState(null),[re,ne]=S.useState({title:"Playdate at the Park",type:"park",date:(new Date).toISOString().split("T")[0],startTime:"10:00",endTime:"11:30",description:"Let's meet up for some fun!",notes:""}),ce=S.useMemo(()=>(Q||[]).filter(e=>e.matchId===a.id),[Q,a.id]),de=e=>{switch(e){case"park":return z.jsx(B,{size:20,weight:"fill"});case"walk":return z.jsx(q,{size:20});case"playdate":return z.jsx(_,{size:20,weight:"fill"});default:return z.jsx(P,{size:20})}},oe=e=>{switch(e){case"confirmed":return"text-green-600 bg-green-100 dark:bg-green-900/20";case"pending":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/20";case"completed":return"text-blue-600 bg-blue-100 dark:bg-blue-900/20";case"cancelled":return"text-gray-600 bg-gray-100 dark:bg-gray-900/20"}},me=S.useCallback(()=>{if(!ie)return void T.error("Please select a location");const e=re.date??(new Date).toISOString().split("T")[0],t={id:`playdate-${Date.now()}`,matchId:a.id,petIds:[C.id,a.matchedPetId],ownerIds:[C.ownerId??"user",a.matchedPetId],title:re.title,type:re.type,date:e,startTime:re.startTime??"10:00",endTime:re.endTime??"11:30",location:ie,description:re.description,status:"pending",createdBy:"user",notes:re.notes,reminderSent:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};Z(e=>[...e||[],t]),s.success(),T.success("Playdate scheduled!",{description:`Invitation sent for ${R(new Date(e),"MMM dd, yyyy")}`}),se(!1),le(null)},[ie,a.id,a.matchedPetId,C.id,C.ownerId,re,Z]),xe=S.useCallback(e=>{le(e),te(!1)},[]),he=S.useCallback(e=>{if(!e.location.lat||!e.location.lng)return void T.error("Location coordinates not available");const a=`https://www.google.com/maps/search/?api=1&query=${e.location.lat},${e.location.lng}`;try{navigator.share?navigator.share({title:e.title,text:`Meet me at ${e.location.name}`,url:a}).then(()=>{T.success("Location shared!"),s.success()}).catch(s=>{if(s instanceof Error&&"AbortError"!==s.name){const a=s instanceof Error?s:new Error(String(s));G.error("PlaydateScheduler shareLocation error",a,{playdateId:e.id}),T.error("Failed to share location. Please try again.")}}):navigator.clipboard.writeText(a).then(()=>{T.success("Location link copied to clipboard!"),s.success()}).catch(s=>{const a=s instanceof Error?s:new Error(String(s));G.error("PlaydateScheduler copyToClipboard error",a,{playdateId:e.id}),T.error("Failed to copy location link. Please try again.")})}catch(t){const s=t instanceof Error?t:new Error(String(t));G.error("PlaydateScheduler shareLocation sync error",s,{playdateId:e.id}),T.error("Failed to share location. Please try again.")}},[]),ue=S.useCallback(e=>{if(!e.location.lat||!e.location.lng){T.info("Opening location in maps...");const s=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.location.address)}`;return void window.open(s,"_blank")}const a=`https://www.google.com/maps/dir/?api=1&destination=${e.location.lat},${e.location.lng}`;window.open(a,"_blank"),s.success()},[]),pe=S.useCallback(e=>{Z(s=>(s||[]).map(s=>s.id===e?{...s,status:"confirmed",updatedAt:(new Date).toISOString()}:s)),s.success(),T.success("Playdate confirmed!",{description:"Both parties have confirmed"})},[Z]),je=S.useCallback(e=>{Z(s=>(s||[]).map(s=>s.id===e?{...s,status:"cancelled",updatedAt:(new Date).toISOString()}:s)),s.light(),T.info("Playdate cancelled",{description:"The other party has been notified"})},[Z]);return z.jsxs(t,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/95 backdrop-blur-sm z-50 overflow-auto",children:[z.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8",children:[z.jsxs("div",{className:"flex items-center justify-between mb-6",children:[z.jsxs("div",{className:"flex items-center gap-3",children:[z.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center",children:z.jsx(P,{size:24,className:"text-white",weight:"fill"})}),z.jsxs("div",{children:[z.jsx("h1",{className:"text-2xl font-bold",children:"Playdate Scheduler"}),z.jsxs("p",{className:"text-sm text-muted-foreground",children:["Coordinate meetups with ",a.matchedPetName]})]})]}),z.jsxs("div",{className:"flex items-center gap-2",children:[X&&z.jsx(i,{variant:"ghost",size:"icon",onClick:X,className:"hover:bg-primary/10","aria-label":"Start video call",title:"Start video call",children:z.jsx(I,{size:22,weight:"fill",className:"text-primary"})}),J&&z.jsx(i,{variant:"ghost",size:"icon",onClick:J,className:"hover:bg-primary/10","aria-label":"Start voice call",title:"Start voice call",children:z.jsx(D,{size:22,weight:"fill",className:"text-primary"})}),z.jsx(i,{variant:"ghost",size:"icon",onClick:K,"aria-label":"Close playdate scheduler",title:"Close",children:z.jsx(E,{size:24})})]})]}),z.jsxs(l,{defaultValue:"upcoming",className:"w-full",children:[z.jsxs(r,{className:"grid w-full grid-cols-2",children:[z.jsx(n,{value:"upcoming",children:"Upcoming"}),z.jsx(n,{value:"history",children:"History"})]}),z.jsx(c,{value:"upcoming",className:"mt-4",children:z.jsxs(d,{children:[z.jsx(o,{children:z.jsxs("div",{className:"flex items-center justify-between",children:[z.jsxs("div",{children:[z.jsx(m,{children:"Scheduled Playdates"}),z.jsx(x,{children:"Your upcoming meetups"})]}),z.jsxs(i,{onClick:()=>se(!0),size:"sm",children:[z.jsx(L,{size:16,className:"mr-2"}),"Schedule Playdate"]})]})}),z.jsx(h,{children:z.jsx(u,{className:"h-[500px]",children:z.jsxs(p,{children:[ee&&z.jsxs(t,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-6 p-4 rounded-lg border bg-card/50",children:[z.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create Playdate"}),z.jsxs("div",{className:"space-y-4",children:[z.jsxs("div",{children:[z.jsx(j,{htmlFor:"title",children:"Title"}),z.jsx(g,{id:"title",value:re.title,onChange:e=>ne(s=>({...s,title:e.target.value})),placeholder:"Playdate at the Park"})]}),z.jsxs("div",{children:[z.jsx(j,{htmlFor:"type",children:"Type"}),z.jsxs(f,{value:re.type,onValueChange:e=>ne(s=>({...s,type:e})),children:[z.jsx(y,{children:z.jsx(v,{})}),z.jsxs(N,{children:[z.jsx(b,{value:"park",children:"Park Visit"}),z.jsx(b,{value:"walk",children:"Walk Together"}),z.jsx(b,{value:"playdate",children:"General Playdate"}),z.jsx(b,{value:"training",children:"Training Session"}),z.jsx(b,{value:"event",children:"Pet Event"}),z.jsx(b,{value:"other",children:"Other"})]})]})]}),z.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[z.jsxs("div",{children:[z.jsx(j,{htmlFor:"date",children:"Date"}),z.jsx(g,{id:"date",type:"date",value:re.date,onChange:e=>ne(s=>({...s,date:e.target.value}))})]}),z.jsxs("div",{children:[z.jsx(j,{htmlFor:"startTime",children:"Start Time"}),z.jsx(g,{id:"startTime",type:"time",value:re.startTime,onChange:e=>ne(s=>({...s,startTime:e.target.value}))})]}),z.jsxs("div",{children:[z.jsx(j,{htmlFor:"endTime",children:"End Time"}),z.jsx(g,{id:"endTime",type:"time",value:re.endTime,onChange:e=>ne(s=>({...s,endTime:e.target.value}))})]})]}),z.jsxs("div",{children:[z.jsx(j,{children:"Location"}),ie?z.jsx(d,{className:"p-3 bg-accent/5 border-primary/20",children:z.jsxs("div",{className:"flex items-start justify-between",children:[z.jsxs("div",{className:"flex items-start gap-2",children:[z.jsx(M,{size:18,className:"text-primary mt-0.5",weight:"fill"}),z.jsxs("div",{children:[z.jsx("p",{className:"font-medium text-sm",children:ie.name}),z.jsx("p",{className:"text-xs text-muted-foreground",children:ie.address})]})]}),z.jsx(i,{variant:"ghost",size:"sm",onClick:()=>te(!0),children:"Change"})]})}):z.jsxs(i,{variant:"outline",className:"w-full justify-start",onClick:()=>te(!0),children:[z.jsx(F,{size:18,className:"mr-2"}),"Choose Location"]})]}),z.jsxs("div",{children:[z.jsx(j,{htmlFor:"description",children:"Description"}),z.jsx(w,{id:"description",value:re.description,onChange:e=>ne(s=>({...s,description:e.target.value})),placeholder:"Let's meet up for some fun!",rows:3})]}),z.jsxs("div",{className:"flex gap-2",children:[z.jsxs(i,{onClick:me,className:"flex-1",children:[z.jsx(O,{size:16,className:"mr-2"}),"Schedule Playdate"]}),z.jsx(i,{variant:"outline",onClick:()=>se(!1),className:"flex-1",children:"Cancel"})]})]})]}),0===ce.filter(e=>"completed"!==e.status&&"cancelled"!==e.status).length?z.jsxs("div",{className:"text-center py-12",children:[z.jsx(P,{size:48,className:"mx-auto text-muted-foreground mb-3"}),z.jsx("p",{className:"text-muted-foreground",children:"No upcoming playdates"}),z.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Schedule one to meet up!"})]}):z.jsx("div",{className:"space-y-3",children:ce.filter(e=>"completed"!==e.status&&"cancelled"!==e.status).sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()).map((e,s)=>{const a=U(new Date(e.date),new Date),l=W(new Date(e.date));return z.jsxs(t,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"p-4 rounded-lg border bg-card hover:shadow-md transition-shadow",children:[z.jsxs("div",{className:"flex items-start justify-between mb-3",children:[z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:de(e.type)}),z.jsxs("div",{children:[z.jsx("h4",{className:"font-semibold",children:e.title}),z.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-1",children:[z.jsx(P,{size:14}),R(new Date(e.date),"EEE, MMM dd, yyyy"),!l&&(0===a?" • Today!":1===a?" • Tomorrow":` • ${a} days away`)]}),z.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[z.jsx($,{size:14}),e.startTime," - ",e.endTime]})]})]}),z.jsx(k,{className:oe(e.status),children:e.status})]}),z.jsxs("div",{className:"flex items-start gap-2 text-sm mb-3",children:[z.jsx(M,{size:16,className:"text-muted-foreground mt-0.5 shrink-0"}),z.jsxs("div",{children:[z.jsx("p",{className:"font-medium",children:e.location.name}),z.jsx("p",{className:"text-muted-foreground",children:e.location.address})]})]}),e.description&&z.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:e.description}),z.jsxs("div",{className:"flex flex-col gap-2",children:[z.jsxs("div",{className:"flex gap-2",children:["pending"===e.status&&z.jsxs(i,{size:"sm",onClick:()=>pe(e.id),className:"flex-1",children:[z.jsx(O,{size:16,className:"mr-2"}),"Confirm"]}),"cancelled"!==e.status&&z.jsxs(i,{size:"sm",variant:"outline",onClick:()=>je(e.id),className:"flex-1",children:[z.jsx(E,{size:16,className:"mr-2"}),"Cancel"]})]}),z.jsxs("div",{className:"flex gap-2",children:[z.jsxs(i,{size:"sm",variant:"secondary",onClick:()=>ue(e),className:"flex-1",children:[z.jsx(A,{size:16,className:"mr-2",weight:"bold"}),"Directions"]}),z.jsxs(i,{size:"sm",variant:"secondary",onClick:()=>he(e),className:"flex-1",children:[z.jsx(V,{size:16,className:"mr-2",weight:"bold"}),"Share"]})]})]})]},e.id)})})]})})})]})}),z.jsx(c,{value:"history",className:"mt-4",children:z.jsxs(d,{children:[z.jsxs(o,{children:[z.jsx(m,{children:"Past Playdates"}),z.jsx(x,{children:"Your meetup history"})]}),z.jsx(h,{children:z.jsx(u,{className:"h-[500px]",children:0===ce.filter(e=>"completed"===e.status||"cancelled"===e.status).length?z.jsxs("div",{className:"text-center py-12",children:[z.jsx(P,{size:48,className:"mx-auto text-muted-foreground mb-3"}),z.jsx("p",{className:"text-muted-foreground",children:"No past playdates"})]}):z.jsx("div",{className:"space-y-3",children:ce.filter(e=>"completed"===e.status||"cancelled"===e.status).sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()).map((e,s)=>z.jsxs(t,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"p-4 rounded-lg border bg-card opacity-75",children:[z.jsxs("div",{className:"flex items-start justify-between mb-2",children:[z.jsxs("div",{className:"flex items-start gap-3",children:[z.jsx("div",{className:"w-10 h-10 rounded-full bg-muted flex items-center justify-center shrink-0",children:de(e.type)}),z.jsxs("div",{children:[z.jsx("h4",{className:"font-semibold",children:e.title}),z.jsxs("p",{className:"text-sm text-muted-foreground",children:[R(new Date(e.date),"MMM dd, yyyy")," •"," ",e.startTime]})]})]}),z.jsx(k,{className:oe(e.status),children:e.status})]}),z.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[z.jsx(M,{size:14}),e.location.name]})]},e.id))})})})]})})]})]}),ae&&z.jsx(Y,{fallback:z.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:z.jsx(d,{className:"p-6",children:z.jsxs("div",{className:"text-center",children:[z.jsx("p",{className:"text-destructive mb-2",children:"Failed to load location picker"}),z.jsx(i,{onClick:()=>te(!1),children:"Close"})]})})}),children:z.jsx(S.Suspense,{fallback:z.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:z.jsxs("div",{className:"text-center",children:[z.jsx(t,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),z.jsx("p",{className:"text-muted-foreground",children:"Loading map..."})]})}),children:z.jsx(H,{...null!==ie?{value:ie}:{},onChange:xe,onClose:()=>te(!1)})})})]})}export{K as default};
