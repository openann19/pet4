import{r as e,j as s,ab as t,cB as a,W as i,ac as l,aj as n,cg as r,ag as o}from"./react-vendor-atdIga2R.js";import{M as c,d,C as m,B as x}from"./feature-admin-g8AIjMAb.js";import{g as u,c as h,f as p}from"./view-CommunityView.tsx-CD5NUxZ2.js";import{i as f}from"./utils-vendor-7mYxNw04.js";import"./vendor-B2U5onNE.js";import"./ui-vendor-CttiZxwU.js";import"./feature-adoption-C919WvgL.js";import"./feature-community-DxZ7YsOF.js";import"./view-AdoptionView.tsx-BJlxubb2.js";function j({playdates:j,onSelectPlaydate:g,onClose:v}){const[N,y]=e.useState(null),[b,w]=e.useState(null),[z,k]=e.useState("map");e.useEffect(()=>{u().then(e=>{e&&"number"==typeof e.lat&&"number"==typeof e.lng&&y(e)}).catch(e=>{if(e instanceof Error&&"NotAllowedError"!==e.name){const s=e instanceof Error?e:new Error(String(e));logger.error("PlaydateMap getCurrentLocation error",s)}})},[]);const C=j.filter(e=>{var s,t;return(null==(s=null==e?void 0:e.location)?void 0:s.lat)&&"number"==typeof e.location.lat&&(null==(t=null==e?void 0:e.location)?void 0:t.lng)&&"number"==typeof e.location.lng&&"cancelled"!==(null==e?void 0:e.status)}),M=e=>{if(e)try{w(e),g&&g(e)}catch(s){}},E=e=>{var s,t;if(!N||!(null==(s=null==e?void 0:e.location)?void 0:s.lat)||"number"!=typeof e.location.lat||!(null==(t=null==e?void 0:e.location)?void 0:t.lng)||"number"!=typeof e.location.lng)return null;try{const s=h(N,{lat:e.location.lat,lng:e.location.lng});return p(s)}catch(a){return null}};return s.jsx(c,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/98 backdrop-blur-md z-50 overflow-auto",children:s.jsxs("div",{className:"max-w-6xl mx-auto p-4 sm:p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center",children:s.jsx(t,{size:24,className:"text-white",weight:"fill"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Playdate Locations"}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[C.length," upcoming playdate",1!==C.length?"s":""]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(d,{variant:"map"===z?"default":"outline",size:"sm",onClick:()=>k("map"),children:[s.jsx(t,{size:18,className:"sm:mr-2"}),s.jsx("span",{className:"hidden sm:inline",children:"Map"})]}),s.jsxs(d,{variant:"list"===z?"default":"outline",size:"sm",onClick:()=>k("list"),children:[s.jsx(a,{size:18,className:"sm:mr-2"}),s.jsx("span",{className:"hidden sm:inline",children:"List"})]}),v&&s.jsx(d,{variant:"ghost",size:"icon",onClick:v,children:s.jsx(i,{size:24})})]})]}),"map"===z?s.jsx(m,{className:"overflow-hidden mb-6",children:s.jsxs("div",{className:"relative w-full h-[500px] bg-gradient-to-br from-primary/10 via-accent/10 to-secondary/10",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-2xl px-4",children:[s.jsx(t,{size:64,className:"mx-auto mb-4 text-muted-foreground"}),s.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Interactive Playdate Map"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Visualization of all your upcoming playdate locations with directions and distance info"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 max-w-2xl mx-auto",children:C.slice(0,6).map((e,t)=>{const a=E(e);return s.jsx(c,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1*t},children:s.jsxs(m,{className:"p-3 cursor-pointer hover:shadow-lg transition-all "+((null==b?void 0:b.id)===e.id?"ring-2 ring-primary bg-primary/5":"hover:bg-accent/5"),onClick:()=>M(e),children:[s.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[s.jsx(l,{size:20,weight:"fill",className:(null==b?void 0:b.id)===e.id?"text-primary":"text-muted-foreground"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-sm truncate",children:e.location.name}),s.jsx("p",{className:"text-xs text-muted-foreground truncate",children:e.location.address})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[s.jsx(n,{size:12}),f(new Date(e.date),"MMM dd")]}),a&&s.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[s.jsx(r,{size:12}),a]})]})]})},e.id)})})]})}),N&&s.jsx(c,{initial:{scale:0},animate:{scale:1},className:"absolute top-4 right-4 bg-card/95 backdrop-blur-sm p-3 rounded-lg shadow-lg border",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500 animate-pulse"}),s.jsx("span",{className:"text-sm font-medium",children:"Your Location"})]})})]})}):s.jsxs("div",{className:"space-y-3",children:[C.map((e,t)=>{const a=E(e);return s.jsx(c,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},children:s.jsx(m,{className:"p-4 cursor-pointer hover:shadow-lg transition-all "+((null==b?void 0:b.id)===e.id?"ring-2 ring-primary bg-primary/5":"hover:bg-accent/5"),onClick:()=>M(e),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-primary/10 to-accent/10 flex items-center justify-center shrink-0",children:s.jsx(l,{size:24,weight:"fill",className:"text-primary"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-lg mb-1",children:e.title}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-2",children:[s.jsx(n,{size:14}),f(new Date(e.date),"EEE, MMM dd, yyyy"),s.jsx(o,{size:14,className:"ml-2"}),e.startTime]}),s.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[s.jsx(l,{size:16,className:"text-muted-foreground mt-0.5 shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-sm",children:e.location.name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:e.location.address})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(x,{variant:"outline",children:e.type}),s.jsx(x,{variant:"confirmed"===e.status?"default":"secondary",children:e.status}),a&&s.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1 ml-auto",children:[s.jsx(r,{size:12}),a," away"]})]})]})]})})},e.id)}),0===C.length&&s.jsx(m,{className:"p-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx(l,{size:48,className:"mx-auto mb-3 text-muted-foreground"}),s.jsx("p",{className:"text-muted-foreground",children:"No upcoming playdates with locations"})]})})]}),b&&s.jsx(c,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fixed bottom-6 left-1/2 -translate-x-1/2 w-full max-w-md px-4",children:s.jsxs(m,{className:"p-4 shadow-2xl border-2 border-primary/20 bg-card/98 backdrop-blur-lg",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-lg",children:b.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:b.location.name})]}),s.jsx(d,{variant:"ghost",size:"icon",onClick:()=>w(null),children:s.jsx(i,{size:20})})]}),s.jsxs(d,{onClick:()=>(e=>{var s,t;if((null==(s=null==e?void 0:e.location)?void 0:s.lat)&&"number"==typeof e.location.lat&&(null==(t=null==e?void 0:e.location)?void 0:t.lng)&&"number"==typeof e.location.lng)try{const s=`https://www.google.com/maps/dir/?api=1&destination=${e.location.lat},${e.location.lng}`;"undefined"!=typeof window&&window.open(s,"_blank")}catch(a){}})(b),className:"w-full",children:[s.jsx(r,{size:18,className:"mr-2",weight:"bold"}),"Get Directions"]})]})})]})})}export{j as default};
