var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{r as s,j as a,aK as i,ak as r,at as n,bE as l,bB as o,a5 as c,W as d,ac as u,bF as m,am as h,bx as g,bi as x,bh as p,bC as f,bD as y,bG as v,bH as b,bv as w,b7 as j,a3 as N,bI as S,bJ as k,av as C}from"./react-vendor-atdIga2R.js";import{aj as I,M as F,G as P,H as z,J as E,a9 as A,I as D,F as T,d as U,c as M,p as L,B as R,L as O,ai as B,D as _,g as H,i as $,j as Y,ad as W,ae as G,af as V,ag as q,T as X,h as Z,ak as J,aa as K,f as Q,al as ee,ac as te,am as se,E as ae,k as ie,a6 as re,N as ne,a3 as le,U as oe,an as ce,a as de,a2 as ue,A as me,Y as he,Z as ge}from"./feature-admin-g8AIjMAb.js";import{S as xe,D as pe,a as fe,b as ye,c as ve}from"./feature-community-DxZ7YsOF.js";import{R as be,a as we}from"./feature-adoption-C919WvgL.js";import{A as je}from"./feature-chat-CPR2_-OR.js";const Ne=s.memo(function({stories:e,petName:t,petPhoto:r,isOwn:n=!1,hasUnviewed:l=!1,onClick:o}){const c=s.useMemo(()=>I(e),[e]).length>0;return a.jsxs(F,{as:"button",onClick:o,className:"flex flex-col items-center gap-2 shrink-0",whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsx("div",{className:"relative",children:n&&!c?a.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-primary/20 to-accent/20 flex items-center justify-center border-2 border-dashed border-primary",children:a.jsx(i,{size:24,weight:"bold",className:"text-primary"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-16 h-16 rounded-full p-0.5 "+(l?"bg-gradient-to-tr from-primary via-accent to-secondary":"bg-muted"),children:a.jsxs(P,{className:"w-full h-full border-2 border-background",children:[a.jsx(z,{src:r,alt:t}),a.jsx(E,{className:"bg-gradient-to-br from-primary to-accent text-white font-bold text-lg",children:t[0]})]})}),n&&c&&a.jsx("div",{className:"absolute bottom-0 right-0 w-5 h-5 rounded-full bg-primary border-2 border-background flex items-center justify-center",children:a.jsx(i,{size:12,weight:"bold",className:"text-white"})})]})}),a.jsx("span",{className:"text-xs font-medium truncate w-16 text-center",children:n?"Your Story":t})]})},(e,t)=>e.petName===t.petName&&e.petPhoto===t.petPhoto&&e.isOwn===t.isOwn&&e.hasUnviewed===t.hasUnviewed&&e.stories.length===t.stories.length&&e.stories.every((e,s)=>{var a;return e.id===(null==(a=t.stories[s])?void 0:a.id)})&&e.onClick===t.onClick),Se=[{id:"music-1",title:"Happy Paws",artist:"Pet Tunes",provider:"licensed",duration:30,previewUrl:"#"},{id:"music-2",title:"Playful Day",artist:"Animal Beats",provider:"licensed",duration:30,previewUrl:"#"},{id:"music-3",title:"Adventure Time",artist:"Woof Records",provider:"licensed",duration:30,previewUrl:"#"}],ke=["â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜","ðŸ”¥","ðŸ‘","ðŸ¾","ðŸ’¯"],Ce=[{id:"filter-none",name:"Original",category:"natural",cssFilter:"none",intensity:1},{id:"filter-warm",name:"Warm Glow",category:"natural",cssFilter:"sepia(0.3) saturate(1.3) brightness(1.1)",intensity:.7},{id:"filter-cool",name:"Cool Breeze",category:"modern",cssFilter:"hue-rotate(20deg) saturate(1.2) brightness(1.05)",intensity:.6},{id:"filter-vintage",name:"Vintage",category:"vintage",cssFilter:"sepia(0.5) contrast(0.9) brightness(1.1)",intensity:.8},{id:"filter-noir",name:"Noir",category:"dramatic",cssFilter:"grayscale(1) contrast(1.3) brightness(0.9)",intensity:1},{id:"filter-vibrant",name:"Vibrant",category:"playful",cssFilter:"saturate(1.8) contrast(1.1)",intensity:.9},{id:"filter-dreamy",name:"Dreamy",category:"artistic",cssFilter:"brightness(1.1) saturate(0.8) contrast(0.9) blur(0.3px)",intensity:.7},{id:"filter-sunset",name:"Golden Sunset",category:"dramatic",cssFilter:"sepia(0.4) saturate(1.4) hue-rotate(-10deg) brightness(1.1)",intensity:.8},{id:"filter-ocean",name:"Ocean Blue",category:"modern",cssFilter:"hue-rotate(180deg) saturate(1.2) brightness(1.05)",intensity:.7},{id:"filter-forest",name:"Forest Green",category:"natural",cssFilter:"hue-rotate(80deg) saturate(1.3) brightness(0.95)",intensity:.75},{id:"filter-pink",name:"Pink Dreams",category:"playful",cssFilter:"hue-rotate(-30deg) saturate(1.5) brightness(1.15)",intensity:.8},{id:"filter-sharp",name:"Ultra Sharp",category:"modern",cssFilter:"contrast(1.3) saturate(1.2) brightness(1.05)",intensity:.9},{id:"filter-soft",name:"Soft Focus",category:"artistic",cssFilter:"brightness(1.15) contrast(0.85) saturate(0.9)",intensity:.6},{id:"filter-neon",name:"Neon Nights",category:"dramatic",cssFilter:"saturate(2) contrast(1.4) brightness(0.9)",intensity:1},{id:"filter-pastel",name:"Pastel",category:"playful",cssFilter:"saturate(0.6) brightness(1.2) contrast(0.9)",intensity:.7}],Ie=[{id:"template-classic",name:"Classic",description:"Clean and simple",category:"Basic",layoutType:"single",backgroundColor:"#ffffff"},{id:"template-sunset",name:"Sunset Dreams",description:"Warm gradient perfect for golden hour",category:"Colorful",layoutType:"single",backgroundGradient:["#FF6B6B","#FFD93D","#FFA500"],animationStyle:"fade",textPosition:"bottom",textStyle:{fontFamily:"Inter",fontSize:"24px",color:"#ffffff",textShadow:"0 2px 8px rgba(0,0,0,0.5)",fontWeight:"700"}},{id:"template-ocean",name:"Ocean Waves",description:"Cool and refreshing blue tones",category:"Colorful",layoutType:"single",backgroundGradient:["#0083B0","#00B4DB","#00D4FF"],animationStyle:"slide",textPosition:"center",textStyle:{fontFamily:"Inter",fontSize:"28px",color:"#ffffff",textShadow:"0 2px 10px rgba(0,0,0,0.6)",fontWeight:"800"}},{id:"template-neon",name:"Neon Vibes",description:"Electric gradient for bold content",category:"Colorful",layoutType:"single",backgroundGradient:["#B721FF","#21D4FD","#FF1CF7"],animationStyle:"zoom",textPosition:"top",textStyle:{fontFamily:"Inter",fontSize:"32px",color:"#ffffff",textShadow:"0 0 20px rgba(183,33,255,0.8)",fontWeight:"900"}},{id:"template-forest",name:"Forest Adventure",description:"Natural green gradient",category:"Colorful",layoutType:"single",backgroundGradient:["#134E5E","#71B280","#A8E6CF"],animationStyle:"fade",textPosition:"bottom",textStyle:{fontFamily:"Inter",fontSize:"26px",color:"#ffffff",textShadow:"0 2px 8px rgba(0,0,0,0.5)",fontWeight:"700"}},{id:"template-collage-2",name:"Side by Side",description:"Two photos in one story",category:"Layout",layoutType:"split",backgroundColor:"#000000",animationStyle:"slide"},{id:"template-collage-3",name:"Triple View",description:"Three photos arranged creatively",category:"Layout",layoutType:"collage",backgroundColor:"#ffffff",animationStyle:"fade"},{id:"template-grid-4",name:"4-Photo Grid",description:"Perfect for showing multiple moments",category:"Layout",layoutType:"grid",backgroundColor:"#f5f5f5",animationStyle:"zoom"},{id:"template-minimal",name:"Minimal White",description:"Clean white background",category:"Basic",layoutType:"single",backgroundColor:"#ffffff",textPosition:"bottom",textStyle:{fontFamily:"Inter",fontSize:"20px",color:"#000000",fontWeight:"600"}},{id:"template-minimal-dark",name:"Minimal Black",description:"Sleek black background",category:"Basic",layoutType:"single",backgroundColor:"#000000",textPosition:"top",textStyle:{fontFamily:"Inter",fontSize:"20px",color:"#ffffff",fontWeight:"600"}},{id:"template-playful",name:"Playful Pop",description:"Fun and energetic",category:"Colorful",layoutType:"single",backgroundGradient:["#FF6B9D","#FEC163","#FAB2FF"],animationStyle:"bounce",textPosition:"center",textStyle:{fontFamily:"Inter",fontSize:"30px",color:"#ffffff",textShadow:"0 4px 12px rgba(0,0,0,0.4)",fontWeight:"800"}},{id:"template-elegant",name:"Elegant Rose",description:"Sophisticated rose gold tones",category:"Colorful",layoutType:"single",backgroundGradient:["#E0AFA0","#F4DECB","#D4A5A5"],animationStyle:"fade",textPosition:"bottom",textStyle:{fontFamily:"Inter",fontSize:"24px",color:"#5A3E3E",fontWeight:"700"}},{id:"template-midnight",name:"Midnight Purple",description:"Deep purple mystery",category:"Colorful",layoutType:"single",backgroundGradient:["#2E1F47","#5E3370","#8B4789"],animationStyle:"fade",textPosition:"center",textStyle:{fontFamily:"Inter",fontSize:"28px",color:"#ffffff",textShadow:"0 2px 10px rgba(0,0,0,0.7)",fontWeight:"700"}},{id:"template-autumn",name:"Autumn Leaves",description:"Warm fall colors",category:"Colorful",layoutType:"single",backgroundGradient:["#D7263D","#F46036","#C84632"],animationStyle:"fade",textPosition:"bottom",textStyle:{fontFamily:"Inter",fontSize:"26px",color:"#ffffff",textShadow:"0 2px 8px rgba(0,0,0,0.5)",fontWeight:"700"}},{id:"template-cherry",name:"Cherry Blossom",description:"Soft pink beauty",category:"Colorful",layoutType:"single",backgroundGradient:["#FFB6C1","#FFC0CB","#FFE4E1"],animationStyle:"fade",textPosition:"top",textStyle:{fontFamily:"Inter",fontSize:"24px",color:"#8B4789",fontWeight:"700"}},{id:"template-arctic",name:"Arctic Ice",description:"Cool winter vibes",category:"Colorful",layoutType:"single",backgroundGradient:["#A8DADC","#F1FAEE","#E3F2FD"],animationStyle:"fade",textPosition:"center",textStyle:{fontFamily:"Inter",fontSize:"26px",color:"#1D3557",fontWeight:"700"}}],Fe=[{id:"all",name:"All Templates",icon:"âœ¨"},{id:"Basic",name:"Basic",icon:"âšª"},{id:"Colorful",name:"Colorful",icon:"ðŸŒˆ"},{id:"Layout",name:"Layout",icon:"ðŸŽ¨"}],Pe=[{id:"all",name:"All Filters",icon:"ðŸŽ­"},{id:"natural",name:"Natural",icon:"ðŸŒ¿"},{id:"vintage",name:"Vintage",icon:"ðŸ“·"},{id:"modern",name:"Modern",icon:"âœ¨"},{id:"artistic",name:"Artistic",icon:"ðŸŽ¨"},{id:"playful",name:"Playful",icon:"ðŸŽª"},{id:"dramatic",name:"Dramatic",icon:"ðŸŽ¬"}];function ze(e,t,s,a,i){return{id:A(),userId:e,petId:t,title:s,coverImage:a,stories:i,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),isPinned:!1}}function Ee(e){return Array.isArray(e)?e.filter(e=>!(new Date(e.expiresAt)<new Date)):[]}function Ae(e){const t=new Date,s=new Date(e),a=t.getTime()-s.getTime(),i=Math.floor(a/6e4),r=Math.floor(i/60),n=Math.floor(r/24);return i<1?"just now":i<60?`${i}m ago`:r<24?`${r}h ago`:`${n}d ago`}function De({selectedTemplate:e,onSelectTemplate:t}){const[i,l]=s.useState("all"),[o,c]=s.useState(""),d=(u=i,"all"===u?Ie:Ie.filter(e=>e.category===u)).filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.description.toLowerCase().includes(o.toLowerCase()));var u;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(r,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),a.jsx(D,{placeholder:"Search templates...",value:o,onChange:e=>c(e.target.value),className:"pl-10"})]}),a.jsx(T,{className:"w-full",children:a.jsx("div",{className:"flex gap-2 pb-2",children:Fe.map(e=>a.jsxs(U,{variant:i===e.id?"default":"outline",size:"sm",onClick:()=>l(e.id),className:M("whitespace-nowrap",i===e.id&&"bg-gradient-to-r from-primary to-accent"),children:[a.jsx("span",{className:"mr-1.5",children:e.icon}),e.name]},e.id))})})]}),a.jsxs(T,{className:"h-[320px]",children:[a.jsx("div",{className:"grid grid-cols-3 gap-3 pr-4",children:a.jsx(L,{mode:"popLayout",children:d.map((s,i)=>a.jsxs(F,{as:"button",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2,delay:.03*i},onClick:()=>t(s),className:M("relative aspect-[9/16] rounded-xl overflow-hidden border-2 transition-all duration-200",e.id===s.id?"border-primary ring-2 ring-primary/20":"border-border hover:border-primary/50"),whileHover:{scale:1.05},whileTap:{scale:.95},style:{background:s.backgroundGradient?`linear-gradient(135deg, ${s.backgroundGradient.join(", ")})`:s.backgroundColor},children:[a.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-2",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs font-bold text-white drop-shadow-lg leading-tight mb-1",children:s.name}),a.jsx("p",{className:"text-[10px] text-white/80 drop-shadow-md",children:s.description})]})}),"Basic"!==s.category&&a.jsx(R,{variant:"secondary",className:"absolute top-1 left-1 text-[9px] px-1.5 py-0 h-4",children:s.category}),e.id===s.id&&a.jsx(F,{initial:{scale:0},animate:{scale:1},className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-primary flex items-center justify-center shadow-lg",children:a.jsx(n,{size:12,weight:"bold",className:"text-white"})}),s.animationStyle&&a.jsx("div",{className:"absolute bottom-1 right-1",children:a.jsx(R,{variant:"secondary",className:"text-[8px] px-1 py-0 h-3 bg-black/40 text-white border-0",children:s.animationStyle})})]},s.id))})}),0===d.length&&a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-8",children:[a.jsx("p",{className:"text-muted-foreground text-sm",children:"No templates found"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Try a different search or category"})]})]})]})}function Te({selectedFilter:e,onSelectFilter:t,mediaPreview:i,intensity:o=1,onIntensityChange:c}){const[d,u]=s.useState("all"),[m,h]=s.useState(""),[g,x]=s.useState(o),p=s.useRef(new Map),f=s.useMemo(()=>{const e="all"===(t=d)?Ce:Ce.filter(e=>e.category===t);var t;const s=m.toLowerCase().trim();return""===s?e:e.filter(e=>e.name.toLowerCase().includes(s))},[d,m]);s.useEffect(()=>{p.current.forEach((e,t)=>{const s=Ce.find(e=>e.id===t);s&&e&&(e.style.filter=s.cssFilter)})},[]),s.useEffect(()=>{x(o)},[o]);const y=s.useCallback(e=>{const t=e[0]??1;x(t),null==c||c(t)},[c]),v=s.useCallback(e=>{u(e)},[]),b=s.useCallback(e=>{h(e.target.value)},[]),w=s.useCallback(e=>{t(e)},[t]),j=s.useCallback(e=>t=>{t?p.current.set(e,t):p.current.delete(e)},[]);return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(r,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),a.jsx(D,{placeholder:"Search filters...",value:m,onChange:b,className:"pl-10","aria-label":"Search story filters"})]}),a.jsx(T,{className:"w-full",children:a.jsx("div",{className:"flex gap-2 pb-2",children:Pe.map(e=>a.jsxs(U,{variant:d===e.id?"default":"outline",size:"sm",onClick:()=>v(e.id),className:M("whitespace-nowrap",d===e.id&&"bg-linear-to-r from-primary to-accent"),"aria-pressed":d===e.id,"aria-label":`Filter category: ${e.name}`,children:[a.jsx("span",{className:"mr-1.5","aria-hidden":"true",children:e.icon}),e.name]},e.id))})})]}),"filter-none"!==e.id&&c&&a.jsxs("div",{className:"glass-effect p-4 rounded-xl space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(O,{className:"text-sm font-semibold flex items-center gap-2",children:[a.jsx(l,{size:16}),"Filter Intensity"]}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(100*g),"%"]})]}),a.jsx(B,{value:[g],onValueChange:y,min:0,max:1,step:.1,className:"w-full"})]}),a.jsxs(T,{className:"h-[280px]",children:[a.jsx("div",{className:"grid grid-cols-3 gap-3 pr-4",children:a.jsx(L,{visible:!0,children:f.map((t,s)=>a.jsxs(F,{as:"button",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2,delay:.03*s},onClick:()=>w(t),"aria-label":`Select filter: ${t.name}`,"aria-pressed":e.id===t.id,className:M("relative aspect-square rounded-xl overflow-hidden border-2 transition-all duration-200 bg-muted",e.id===t.id?"border-primary ring-2 ring-primary/20":"border-border hover:border-primary/50"),whileHover:{scale:1.05},whileTap:{scale:.95},children:[i?a.jsx("img",{ref:j(t.id),src:i,alt:`Preview with ${t.name} filter`,className:"w-full h-full object-cover",style:{filter:t.cssFilter},loading:"lazy"}):a.jsx("div",{className:"w-full h-full",style:{background:"filter-none"===t.id?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",filter:t.cssFilter}}),a.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-black/70 via-transparent to-transparent flex items-end",children:a.jsx("p",{className:"text-[10px] font-semibold text-white px-2 pb-1.5 w-full text-center",children:t.name})}),e.id===t.id&&a.jsx(F,{initial:{scale:0},animate:{scale:1},className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-primary flex items-center justify-center shadow-lg",children:a.jsx(n,{size:12,weight:"bold",className:"text-white"})})]},t.id))})}),0===f.length&&a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-8",children:[a.jsx("p",{className:"text-muted-foreground text-sm",children:"No filters found"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Try a different search or category"})]})]})]})}function Ue({open:e,onOpenChange:t,userId:i,userName:r,petId:n,petName:l,petPhoto:g,userAvatar:x,onStoryCreated:p}){const[f,y]=s.useState(null),[v,b]=s.useState(""),[w,j]=s.useState("photo"),[N,S]=s.useState(""),[k,C]=s.useState("everyone"),[I,P]=s.useState(()=>{const e=Ie[0];if(!e)throw new Error("ADVANCED_STORY_TEMPLATES array is empty");return e}),[z,E]=s.useState(()=>{const e=Ce[0];if(!e)throw new Error("STORY_FILTERS array is empty");return e}),[D,T]=s.useState(1),[M,L]=s.useState(()=>{const e=Se[0];if(!e)throw new Error("STORY_MUSIC_TRACKS array is empty");return e}),[R,B]=s.useState(!1),J=s.useRef(null),K=s.useRef(null),Q=e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(!s)return;const a=s.type.startsWith("video/");j(a?"video":"photo"),y(s);const i=new FileReader;i.onloadend=()=>{b(i.result)},i.readAsDataURL(s)},ee=()=>{y(null),b(""),S(""),C("everyone"),t(!1)};return a.jsxs(a.Fragment,{children:[a.jsx("input",{ref:J,type:"file",accept:"image/*,video/*",className:"hidden",onChange:Q}),a.jsx("input",{ref:K,type:"file",accept:"image/*,video/*",capture:"environment",className:"hidden",onChange:Q}),a.jsx(_,{open:e,onOpenChange:t,children:a.jsxs(H,{className:"max-w-2xl max-h-[90vh] overflow-hidden glass-strong",children:[a.jsx($,{children:a.jsx(Y,{children:"Create Story"})}),a.jsxs(W,{defaultValue:"content",className:"w-full",children:[a.jsxs(G,{className:"grid w-full grid-cols-4",children:[a.jsx(V,{value:"content",children:"Content"}),a.jsx(V,{value:"templates",children:"Templates"}),a.jsx(V,{value:"filters",children:"Filters"}),a.jsx(V,{value:"settings",children:"Settings"})]}),a.jsx(q,{value:"content",className:"space-y-4",children:v?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative aspect-9/16 max-h-96 bg-black rounded-2xl overflow-hidden",children:["photo"===w?a.jsx("img",{src:v,alt:"Story preview",className:"w-full h-full object-contain"}):a.jsx("video",{src:v,className:"w-full h-full object-contain",controls:!0}),a.jsx(U,{size:"icon",variant:"destructive",className:"absolute top-2 right-2",onClick:()=>{y(null),b("")},children:a.jsx(d,{size:20})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(O,{htmlFor:"caption",children:"Caption (optional)"}),a.jsx(X,{id:"caption",value:N,onChange:e=>S(e.target.value),placeholder:"Add a caption to your story...",rows:3,maxLength:150,className:"resize-none"}),a.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[N.length,"/150"]})]})]}):a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs(F,{as:"button",onClick:()=>{var e;null==(e=K.current)||e.click()},className:"glass-effect p-8 rounded-2xl flex flex-col items-center gap-3 hover:bg-white/20 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-linear-to-br from-primary to-accent flex items-center justify-center",children:a.jsx(o,{size:32,weight:"fill",className:"text-white"})}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"font-semibold",children:"Take Photo"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Use your camera"})]})]}),a.jsxs(F,{as:"button",onClick:()=>{var e;null==(e=J.current)||e.click()},className:"glass-effect p-8 rounded-2xl flex flex-col items-center gap-3 hover:bg-white/20 transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-linear-to-br from-secondary to-primary flex items-center justify-center",children:a.jsx(c,{size:32,weight:"fill",className:"text-white"})}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"font-semibold",children:"Choose Media"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"From your gallery"})]})]})]})})}),a.jsx(q,{value:"templates",className:"space-y-4",children:a.jsx(De,{selectedTemplate:I,onSelectTemplate:P})}),a.jsx(q,{value:"filters",className:"space-y-4",children:a.jsx(Te,{selectedFilter:z,onSelectFilter:E,mediaPreview:v,intensity:D,onIntensityChange:T})}),a.jsxs(q,{value:"settings",className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx(O,{children:"Privacy"}),a.jsxs(be,{value:k,onValueChange:e=>C(e),children:[a.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg glass-effect",children:[a.jsx(we,{value:"everyone",id:"everyone"}),a.jsxs(O,{htmlFor:"everyone",className:"flex-1 cursor-pointer",children:[a.jsx("div",{className:"font-semibold",children:"Everyone"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"All PawfectMatch users can view"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg glass-effect",children:[a.jsx(we,{value:"matches-only",id:"matches-only"}),a.jsxs(O,{htmlFor:"matches-only",className:"flex-1 cursor-pointer",children:[a.jsx("div",{className:"font-semibold",children:"Matches Only"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Only your matches can view"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg glass-effect",children:[a.jsx(we,{value:"close-friends",id:"close-friends"}),a.jsxs(O,{htmlFor:"close-friends",className:"flex-1 cursor-pointer",children:[a.jsx("div",{className:"font-semibold",children:"Close Friends"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Only close friends can view"})]})]})]})]}),a.jsxs("div",{className:"glass-effect p-4 rounded-lg space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[a.jsx(u,{size:16}),a.jsx("span",{className:"text-sm",children:"Your story will expire in 24 hours"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[a.jsx(m,{size:16}),a.jsx("span",{className:"text-sm",children:"Viewers can react and reply to your story"})]})]})]})]}),a.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[a.jsx(U,{variant:"outline",onClick:ee,disabled:R,children:"Cancel"}),a.jsx(U,{onClick:async()=>{if(v){B(!0),Z.trigger("success");try{const e=function(e,t,s,a,i,r,n,l,o){const c=new Date,d=new Date(c.getTime()+864e5);return{id:A(),userId:e,userName:t,...o?{userAvatar:o}:{},petId:s,petName:a,petPhoto:i,type:n,mediaUrl:r,duration:"photo"===n?5:15,createdAt:c.toISOString(),expiresAt:d.toISOString(),visibility:l,viewCount:0,views:[],reactions:[]}}(i,r,n,l,g,v,w,k,x);N&&(e.caption=N),"template-classic"!==I.id&&(e.template=I),M&&"music-1"!==M.id&&(e.music={id:M.id,title:M.title??"",artist:M.artist??"",provider:M.provider??"licensed",duration:M.duration??30,previewUrl:M.previewUrl??"",startTime:0}),p(e),h.success("Story created!",{description:"Your story is now live for 24 hours",duration:3e3}),ee()}catch(e){h.error("Failed to create story")}finally{B(!1)}}else h.error("Please select a photo or video")},disabled:!v||R,className:"bg-linear-to-r from-primary to-accent",children:R?"Creating...":"Share Story"})]})]})})]})}function Me({allStories:e,currentUserId:t,currentUserName:i,currentUserPetId:r,currentUserPetName:n,currentUserPetPhoto:l,currentUserAvatar:o,onStoryCreated:c,onStoryUpdate:d}){const[u,m]=s.useState(null),[h,g]=s.useState(!1),x=s.useMemo(()=>I(e),[e]),p=s.useMemo(()=>J(x),[x]),f=s.useMemo(()=>x.filter(e=>e.userId===t),[x,t]),y=s.useMemo(()=>x.filter(e=>e.userId!==t),[x,t]),v=s.useMemo(()=>Array.from(new Set([...y.map(e=>e.userId)])),[y]),b=s.useCallback(e=>{const t=p.get(e);t&&t.length>0&&m(t)},[p]),w=s.useCallback(()=>{f.length>0?m(f):g(!0)},[f]),j=s.useCallback(()=>{m(null)},[]),N=s.useCallback(()=>{g(!0)},[]);return 0===x.length&&0===f.length?a.jsxs(a.Fragment,{children:[a.jsx(F,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"glass-strong p-4 rounded-3xl backdrop-blur-2xl border border-white/20 mb-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Share Your Story"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Be the first to share a story!"})]}),a.jsx("button",{onClick:N,className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center text-white font-bold text-xl shadow-lg hover:scale-105 transition-transform",children:"+"})]})}),a.jsx(Ue,{open:h,onOpenChange:g,userId:t,userName:i,petId:r,petName:n,petPhoto:l,userAvatar:o,onStoryCreated:c})]}):a.jsxs(a.Fragment,{children:[a.jsx(F,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"glass-strong p-4 rounded-3xl backdrop-blur-2xl border border-white/20 mb-6",children:a.jsx(T,{className:"w-full",children:a.jsxs("div",{className:"flex gap-4 pb-2",children:[a.jsx(Ne,{stories:f,petName:n,petPhoto:l,isOwn:!0,onClick:w}),v.map(e=>{const s=p.get(e);if(!s||0===s.length)return null;const i=s[0];return a.jsx(Ne,{stories:s,petName:i.petName,petPhoto:i.petPhoto,hasUnviewed:!s.some(e=>Array.isArray(e.views)&&e.views.some(e=>e.userId===t)),onClick:()=>b(e)},e)})]})})}),u&&a.jsx(s.Suspense,{fallback:a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}),children:a.jsx(xe,{stories:u,currentUserId:t,currentUserName:i,currentUserAvatar:o,onClose:j,onStoryUpdate:d})}),a.jsx(Ue,{open:h,onOpenChange:g,userId:t,userName:i,petId:r,petName:n,petPhoto:l,userAvatar:o,onStoryCreated:c})]})}const Le=Q("AnalyticsAPI",void 0,{enableSentry:!1});const Re=new class{async trackEvent(e){try{const t={event:e};await K.post("/analytics/events",t)}catch(t){const s=t instanceof Error?t:new Error(String(t));Le.error("Failed to track event",s,{event:e})}}async createSession(e){try{const t={session:e};return(await K.post("/analytics/sessions",t)).data.session}catch(t){const e=t instanceof Error?t:new Error(String(t));throw Le.error("Failed to create analytics session",e),e}}async getMetrics(e,t){try{const s=new URLSearchParams;e&&s.append("startDate",e),t&&s.append("endDate",t);const a="/analytics/metrics"+(s.toString()?`?${s.toString()}`:"");return(await K.get(a)).data.metrics}catch(s){const e=s instanceof Error?s:new Error(String(s));throw Le.error("Failed to get analytics metrics",e),e}}async getUserBehaviorInsights(e){try{return(await K.get(`/analytics/insights/${e}`)).data.insights}catch(t){const s=t instanceof Error?t:new Error(String(t));throw Le.error("Failed to get user behavior insights",s,{userId:e}),s}}},Oe=Q("advanced-analytics");class Be{constructor(){t(this,"sessionId"),t(this,"userId"),t(this,"sessionStart"),t(this,"events",[]),this.sessionId=ee(),this.sessionStart=Date.now(),this.initializeSession()}async initializeSession(){const e=localStorage.getItem("user-id")||void 0;e&&(this.userId=e),await this.trackEvent("session_start",{entryPoint:window.location.pathname,referrer:document.referrer})}async trackEvent(e,t={}){if(!this.hasAnalyticsConsent())return void Oe.debug("Analytics tracking skipped - consent not granted",{eventName:e});const s={id:ee(),name:e,timestamp:(new Date).toISOString(),sessionId:this.sessionId,...this.userId?{userId:this.userId}:{},properties:{...t,url:window.location.href,pathname:window.location.pathname},correlationId:ee()};this.events.push(s);try{await Re.trackEvent(s)}catch(a){const t=a instanceof Error?a:new Error(String(a));Oe.error("Failed to track event via API, storing locally",t,{name:e});const i=await te.get("analytics-events")||[];i.push(s),await te.set("analytics-events",i.slice(-1e4))}Oe.debug("Analytics event",{name:e,properties:t})}hasAnalyticsConsent(){var e;if("undefined"==typeof window)return!1;try{const t=localStorage.getItem("gdpr-consent");if(!t)return!1;return!0===(null==(e=JSON.parse(t).value)?void 0:e.analytics)}catch{return!1}}async trackPageView(e,t={}){await this.trackEvent("page_view",{path:e,...t})}async trackFeatureUse(e,t={}){await this.trackEvent("feature_used",{featureName:e,...t})}async trackError(e,t={}){await this.trackEvent("error_occurred",{errorMessage:e.message,errorStack:e.stack,...t})}async endSession(){var e,t;const s=Date.now()-this.sessionStart;await this.trackEvent("session_end",{duration:s,eventCount:this.events.length,exitPoint:window.location.pathname});const a={id:this.sessionId,...this.userId?{userId:this.userId}:{},startTime:new Date(this.sessionStart).toISOString(),endTime:(new Date).toISOString(),events:this.events,deviceInfo:{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,screenSize:`${window.innerWidth}x${window.innerHeight}`},entryPoint:(null==(t=null==(e=this.events[0])?void 0:e.properties)?void 0:t.pathname)||"/",exitPoint:window.location.pathname};try{await Re.createSession(a)}catch(i){const e=i instanceof Error?i:new Error(String(i));Oe.error("Failed to create session via API, storing locally",e);const t=await te.get("analytics-sessions")||[];t.push(a),await te.set("analytics-sessions",t.slice(-1e3))}}getSessionId(){return this.sessionId}getUserId(){return this.userId}setUserId(e){this.userId=e}}let _e=null;function He({story:e,currentUserId:t,isActive:a}){const i=s.useRef(null),r=s.useRef(new Set),n=(_e||(_e=new Be,"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{null==_e||_e.endSession()})),_e),l=s.useCallback(()=>{e&&a&&(i.current=Date.now(),n.trackEvent("story_viewed",{storyId:e.id,userId:e.userId,petId:e.petId,storyType:e.type}),se.emit("story_viewed",{storyId:e.id,userId:t,timestamp:(new Date).toISOString()}))},[e,t,a,n]),o=s.useCallback(s=>{if(!e||!i.current)return;const a=(Date.now()-i.current)/1e3;n.trackEvent("story_view_completed",{storyId:e.id,viewDuration:a,completed:s,completionRate:s?a/e.duration*100:0}),se.emit("story_view_completed",{storyId:e.id,userId:t,viewDuration:a,completed:s,timestamp:(new Date).toISOString()}),i.current=null},[e,t,n]),c=s.useCallback(s=>{if(!e)return;const a=`${e.id}-${s}`;r.current.has(a)||(r.current.add(a),n.trackEvent("story_reaction",{storyId:e.id,emoji:s,userId:t}),se.emit("story_reaction",{storyId:e.id,userId:t,emoji:s,timestamp:(new Date).toISOString()}))},[e,t,n]),d=s.useCallback(s=>{e&&(n.trackEvent("story_interaction",{storyId:e.id,interactionType:s,userId:t}),se.emit("story_interaction",{storyId:e.id,userId:t,interactionType:s,timestamp:(new Date).toISOString()}))},[e,t,n]);return s.useEffect(()=>(a&&e&&l(),()=>{if(i.current&&e){const t=(Date.now()-i.current)/1e3>=.8*e.duration;o(t)}}),[a,e,l,o]),s.useEffect(()=>{if(!e)return;const s=s=>{const a=s;a.storyId===e.id&&a.userId!==t&&n.trackEvent("story_reaction_received",{storyId:e.id,emoji:a.emoji,fromUserId:a.userId})},a=s=>{const a=s;a.storyId===e.id&&a.userId!==t&&n.trackEvent("story_view_received",{storyId:e.id,fromUserId:a.userId})};return se.on("story_reaction",s),se.on("story_viewed",a),()=>{se.off("story_reaction",s),se.off("story_viewed",a)}},[e,t,n]),{trackView:l,trackViewComplete:o,trackReaction:c,trackInteraction:d}}function $e({open:e,onOpenChange:t,story:r,onSaved:l}){const[o,c]=ae("story-highlights",[]),[d]=ae("user-pets",[]),[u,m]=s.useState(!1),[x,p]=s.useState(""),[f,y]=s.useState(null),v=(o||[]).filter(e=>e.userId===r.userId),b=e=>{const t=v.find(t=>t.id===e);return(null==t?void 0:t.stories.some(e=>e.id===r.id))||!1},w=()=>{m(!1),p(""),y(null)};return a.jsx(_,{open:e,onOpenChange:e=>{e||w(),t(e)},children:a.jsxs(H,{className:"max-w-md max-h-[80vh] overflow-hidden flex flex-col",children:[a.jsxs($,{children:[a.jsxs(Y,{className:"flex items-center gap-2",children:[a.jsx(g,{size:24,weight:"fill",className:"text-primary"}),"Save to Highlight"]}),a.jsx(ie,{children:"Save this story to a permanent highlight collection"})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:u?a.jsxs(F,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(O,{htmlFor:"new-highlight-title",children:"Highlight Name"}),a.jsx(D,{id:"new-highlight-title",value:x,onChange:e=>p(e.target.value),placeholder:"e.g., Summer Adventures, Best Moments",maxLength:30,autoFocus:!0}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[x.length,"/30 characters"]})]}),a.jsx("div",{className:"aspect-[9/16] max-h-48 rounded-2xl overflow-hidden bg-muted",children:a.jsx("img",{src:r.thumbnailUrl||r.mediaUrl,alt:"Story preview",className:"w-full h-full object-cover"})})]}):a.jsx(T,{className:"h-[400px] pr-4",children:a.jsx("div",{className:"space-y-3 py-4",children:0===v.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(g,{size:48,className:"mx-auto text-muted-foreground mb-3"}),a.jsx("p",{className:"text-muted-foreground mb-2",children:"No highlights yet"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Create your first highlight to save this story"})]}):v.map(e=>{var t,s,i,r;const l=b(e.id),o=f===e.id;return a.jsxs(F,{as:"button",onClick:()=>{return!l&&(t=e.id,void(b(t)?h.error("Story already in this highlight"):(Z.trigger("selection"),y(t))));var t},disabled:l,className:"w-full p-4 rounded-2xl flex items-center gap-4 transition-all "+(l?"opacity-50 cursor-not-allowed bg-muted":o?"bg-primary/20 border-2 border-primary":"glass-effect hover:bg-white/20 dark:hover:bg-white/5"),whileHover:l?{}:{scale:1.02},whileTap:l?{}:{scale:.98},children:[a.jsxs(P,{className:"w-16 h-16 ring-2 ring-border",children:[a.jsx(z,{src:e.coverImage,alt:e.title}),a.jsx(E,{className:"bg-gradient-to-br from-primary to-accent text-white font-bold",children:(null==(s=null==(t=e.title)?void 0:t[0])?void 0:s.toUpperCase())??"?"})]}),a.jsxs("div",{className:"flex-1 text-left min-w-0",children:[a.jsx("p",{className:"font-semibold truncate",children:e.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[(null==(i=e.stories)?void 0:i.length)??0," ",1===(null==(r=e.stories)?void 0:r.length)?"story":"stories"]}),l&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Already added"})]}),o&&!l&&a.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-primary flex items-center justify-center",children:a.jsx(n,{size:18,weight:"bold",className:"text-white"})}),e.isPinned&&a.jsx("div",{className:"shrink-0 text-lg","aria-label":"Pinned",children:"ðŸ“Œ"})]},e.id)})})})}),a.jsx(re,{className:"border-t pt-4",children:u?a.jsxs(a.Fragment,{children:[a.jsx(U,{variant:"outline",onClick:()=>m(!1),children:"Back"}),a.jsxs(U,{onClick:()=>{if(!x.trim())return void h.error("Please enter a highlight title");Z.trigger("success");const e=null==d?void 0:d[0],s=ze(r.userId,(null==e?void 0:e.id)||r.petId,x,r.thumbnailUrl||r.mediaUrl,[r]);c(e=>[...e||[],s]),h.success("Highlight created!",{duration:2e3,description:`"${x}" has been created with this story`}),null==l||l(),t(!1),w()},disabled:!x.trim(),className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:[a.jsx(i,{size:18,weight:"bold",className:"mr-2"}),"Create Highlight"]})]}):a.jsxs(a.Fragment,{children:[a.jsxs(U,{variant:"outline",onClick:()=>m(!0),className:"flex-1",children:[a.jsx(i,{size:18,weight:"bold",className:"mr-2"}),"New Highlight"]}),a.jsxs(U,{onClick:()=>{f&&(Z.trigger("success"),c(e=>(e||[]).map(e=>e.id===f?{...e,stories:[...e.stories,r],updatedAt:(new Date).toISOString()}:e)),h.success("Story saved to highlight!",{duration:2e3,description:"You can view it anytime in your highlights"}),null==l||l(),t(!1),w())},disabled:!f,className:"flex-1 bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:[a.jsx(g,{size:18,weight:"fill",className:"mr-2"}),"Save Story"]})]})})]})})}function Ye({stories:e,initialIndex:t=0,currentUserId:i,currentUserName:r,currentUserAvatar:n,onClose:l,onComplete:o,onStoryUpdate:c}){const[u,m]=s.useState(t),[S,k]=s.useState(!1),[C,I]=s.useState(!1),[F,A]=s.useState(0),[T,M]=s.useState(""),[L,R]=s.useState(!1),[O,B]=s.useState(!1),_=s.useRef(Date.now()),H=s.useRef(null),$=s.useRef(null),Y=s.useRef(null),W=ne(0),G=e[u],V=(null==G?void 0:G.userId)===i,q=le(),{isFullscreen:X,toggleFullscreen:J}=function(){const[e,t]=s.useState(!1);s.useEffect(()=>{const e=()=>{t(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]);const a=s.useCallback(async()=>{const e=document.documentElement;try{e.requestFullscreen?await e.requestFullscreen():"webkitRequestFullscreen"in e&&"function"==typeof e.webkitRequestFullscreen?await e.webkitRequestFullscreen():"mozRequestFullScreen"in e&&"function"==typeof e.mozRequestFullScreen?await e.mozRequestFullScreen():"msRequestFullscreen"in e&&"function"==typeof e.msRequestFullscreen&&await e.msRequestFullscreen()}catch(t){}},[]),i=s.useCallback(async()=>{try{document.exitFullscreen?await document.exitFullscreen():"webkitExitFullscreen"in document&&"function"==typeof document.webkitExitFullscreen?await document.webkitExitFullscreen():"mozCancelFullScreen"in document&&"function"==typeof document.mozCancelFullScreen?await document.mozCancelFullScreen():"msExitFullscreen"in document&&"function"==typeof document.msExitFullscreen&&await document.msExitFullscreen()}catch(e){}},[]),r=s.useCallback(async()=>{e?await i():await a()},[e,a,i]);return{isFullscreen:e,enterFullscreen:a,exitFullscreen:i,toggleFullscreen:r}}(),{trackReaction:K,trackInteraction:Q}=He({story:G||null,currentUserId:i,isActive:!S}),ee=s.useCallback(()=>{const t=(Date.now()-_.current)/1e3,s=t>=.8*((null==G?void 0:G.duration)||5);if(G&&!V){const e=function(e,t,s,a,i,r){const n=e.views.findIndex(e=>e.userId===t),l={userId:t,userName:s,...r?{userAvatar:r}:{},viewedAt:(new Date).toISOString(),viewDuration:a,completedView:i};if(n>=0){const t=[...e.views];return t[n]=l,{...e,views:t,viewCount:e.views.length}}return{...e,views:[...e.views,l],viewCount:e.views.length+1}}(G,i,r,t,s,n||void 0);null==c||c(e)}Q("skip"),u<e.length-1?(m(e=>e+1),A(0)):(null==o||o(),l())},[G,i,r,n,V,u,e.length,c,o,l,Q]),te=s.useCallback(()=>{u>0&&(m(e=>e-1),A(0))},[u]),se=s.useCallback(()=>{Z.trigger("selection"),k(e=>!e)},[]),ae=s.useCallback(()=>{Z.trigger("selection"),I(e=>!e)},[]),{gestureState:ie,handlers:re,reset:xe}=function(e={}){const{onSwipeLeft:t,onSwipeRight:a,onTap:i,onLongPress:r,onPinchZoom:n,enablePinchZoom:l=!0,swipeThreshold:o=50,longPressDelay:c=500}=e,[d,u]=s.useState({isSwiping:!1,swipeDistance:0,isPinching:!1,pinchScale:1,isLongPressing:!1}),m=s.useRef(null),h=s.useRef(0),g=s.useRef(null),x=s.useRef(0),p=s.useRef(null),f=s.useRef([]),y=s.useCallback(()=>{g.current&&(clearTimeout(g.current),g.current=null),u(e=>({...e,isLongPressing:!1}))},[]),v=s.useCallback(e=>{const t=e.touches[0];if(!t)return;const s=Date.now(),a={x:t.clientX,y:t.clientY};if(m.current=a,f.current=Array.from(e.touches).map(e=>({x:e.clientX,y:e.clientY})),1===e.touches.length){const e=s-x.current,t=p.current?Math.sqrt(Math.pow(a.x-p.current.x,2)+Math.pow(a.y-p.current.y,2)):1/0;if(e<300&&t<50)return null==i||i(),void(x.current=0);g.current=window.setTimeout(()=>{u(e=>({...e,isLongPressing:!0})),Z.trigger("medium"),null==r||r()},c)}else if(2===e.touches.length&&l){y();const t=Array.from(e.touches);if(t.length<2)return;const[s,a]=t;if(!s||!a)return;const i=Math.sqrt(Math.pow(s.clientX-a.clientX,2)+Math.pow(s.clientY-a.clientY,2));h.current=i,u(e=>({...e,isPinching:!0}))}},[i,r,l,c,y]),b=s.useCallback(e=>{if(m.current)if(y(),1===e.touches.length){const t=e.touches[0];if(!t)return;const s=t.clientX-m.current.x,a=t.clientY-m.current.y;Math.abs(s)>Math.abs(a)&&Math.abs(s)>10&&u(e=>({...e,isSwiping:!0,swipeDistance:s}))}else if(2===e.touches.length&&l){const t=Array.from(e.touches);if(t.length<2)return;const[s,a]=t;if(!s||!a)return;const i=Math.sqrt(Math.pow(s.clientX-a.clientX,2)+Math.pow(s.clientY-a.clientY,2))/h.current,r=Math.max(1,Math.min(i,3));u(e=>({...e,pinchScale:r})),null==n||n(r)}},[l,n,y]),w=s.useCallback(e=>{if(y(),d.isSwiping&&m.current){const s=e.changedTouches[0];if(s){const e=s.clientX-m.current.x;Math.abs(e)>o&&(e>0&&a?(Z.trigger("light"),a()):e<0&&t&&(Z.trigger("light"),t()))}}const s=e.changedTouches[0];if(s&&!d.isSwiping&&!d.isPinching){const e=Date.now();x.current=e,p.current={x:s.clientX,y:s.clientY}}u({isSwiping:!1,swipeDistance:0,isPinching:!1,pinchScale:1,isLongPressing:!1}),m.current=null,f.current=[]},[d,o,t,a,y]),j=s.useCallback(e=>{0===e.button&&(m.current={x:e.clientX,y:e.clientY},g.current=window.setTimeout(()=>{u(e=>({...e,isLongPressing:!0})),Z.trigger("medium"),null==r||r()},c))},[r,c]),N=s.useCallback(e=>{if(!m.current)return;y();const t=e.clientX-m.current.x;Math.abs(t)>10&&u(e=>({...e,isSwiping:!0,swipeDistance:t}))},[y]),S=s.useCallback(e=>{if(y(),d.isSwiping&&m.current){const s=e.clientX-m.current.x;Math.abs(s)>o&&(s>0&&a?(Z.trigger("light"),a()):s<0&&t&&(Z.trigger("light"),t()))}d.isSwiping||d.isPinching||null==i||i(),u({isSwiping:!1,swipeDistance:0,isPinching:!1,pinchScale:1,isLongPressing:!1}),m.current=null},[d,o,t,a,i,y]);return{gestureState:d,handlers:{onTouchStart:v,onTouchMove:b,onTouchEnd:w,onMouseDown:j,onMouseMove:N,onMouseUp:S},reset:s.useCallback(()=>{y(),u({isSwiping:!1,swipeDistance:0,isPinching:!1,pinchScale:1,isLongPressing:!1}),m.current=null},[y])}}({onSwipeLeft:ee,onSwipeRight:te,onTap:se,onLongPress:()=>{V||R(!0)},onPinchZoom:e=>{Y.current&&(Y.current.style.transform=`scale(${e})`)},enablePinchZoom:"photo"===(null==G?void 0:G.type),swipeThreshold:50}),be=oe(()=>({opacity:he(W.value,[-1,0,1],[.5,1,.5],ge.CLAMP)})),we=oe(()=>({transform:[{scale:he(W.value,[-1,0,1],[.95,1,.95],ge.CLAMP)}]})),Ne=s.useCallback(()=>{H.current&&clearInterval(H.current);const e=(null==G?void 0:G.duration)||5;H.current=window.setInterval(()=>{A(t=>{const s=t+50/(1e3*e)*100;return s>=100?(ee(),0):s})},50)},[G,ee]);s.useEffect(()=>(_.current=Date.now(),A(0),xe(),Y.current&&(Y.current.style.transform="scale(1)"),S||Ne(),()=>{H.current&&clearInterval(H.current)}),[u,S,xe,Ne]),s.useEffect(()=>{"video"===(null==G?void 0:G.type)&&$.current&&(S?($.current.pause(),Q("pause")):$.current.play().catch(()=>{}),$.current.muted=C)},[S,C,G,Q]),s.useEffect(()=>(_.current=Date.now(),A(0),xe(),Y.current&&(Y.current.style.transform="scale(1)"),S||Ne(),()=>{H.current&&clearInterval(H.current)}),[u,S,xe,Ne]),s.useEffect(()=>{"video"===(null==G?void 0:G.type)&&$.current&&(S?($.current.pause(),Q("pause")):$.current.play().catch(()=>{}),$.current.muted=C)},[S,C,G,Q]);const Se=s.useCallback(e=>{if(Z.trigger("success"),G&&!V){K(e);const t={...G,reactions:[...G.reactions,{emoji:e,userId:i,userName:r,...void 0!==n?{userAvatar:n}:{},timestamp:(new Date).toISOString()}]};null==c||c(t)}h.success(`Reacted with ${e}`,{duration:1500,position:"top-center"}),R(!1)},[G,V,i,r,n,K,c]),Ce=s.useCallback(()=>{T.trim()&&(Z.trigger("light"),Q("reply"),h.success("Reply sent!",{duration:2e3,position:"top-center"}),M(""))},[T,Q]),Ie=s.useCallback(()=>{G&&(Z.trigger("selection"),B(!0))},[G]),Fe=s.useCallback(()=>{G&&(Q("share"),navigator.share?navigator.share({title:`Story by ${G.userName}`,text:G.caption||"",url:`${window.location.origin}/stories/${G.id}`}).catch(()=>{}):(navigator.clipboard.writeText(`${window.location.origin}/stories/${G.id}`),h.success("Link copied to clipboard")))},[G,Q]),Pe=q?{duration:0}:{duration:.3,ease:[.4,0,.2,1]},ze=ce({initial:{opacity:0},animate:{opacity:1},transition:Pe}),Ee=de({scale:1.3}),De=ue({scale:.9}),Te=ce({initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0},transition:Pe}),Ue=ce({initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0},transition:Pe}),Me=ce({initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0},transition:Pe}),Le=ce({initial:{scale:q?1:1.1,opacity:0},animate:{scale:ie.pinchScale,opacity:1},transition:Pe}),Re=oe(()=>({opacity:ie.isSwiping?.5:1,transform:[{scale:ie.isSwiping?.95:ie.pinchScale}]}));return G?a.jsxs(me,{style:ze.animatedStyle,className:"fixed inset-0 z-100 bg-black",role:"dialog","aria-modal":"true","aria-label":"Story viewer",...re,children:[a.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[a.jsxs("div",{className:"absolute top-0 left-0 right-0 z-20 p-4 space-y-3","aria-label":"Story progress",children:[a.jsx("div",{className:"flex gap-1",children:e.map((t,s)=>a.jsx("div",{className:"flex-1 h-1 bg-white/30 rounded-full overflow-hidden",role:"progressbar","aria-valuenow":s===u?F:s<u?100:0,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`Story ${s+1} of ${e.length}`,children:a.jsx(me,{className:"h-full bg-white",style:{width:s<u?"100%":s===u?`${F}%`:"0%",transition:q?"none":"width 0.1s linear"}})},s))}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(P,{className:"w-10 h-10 ring-2 ring-white",children:[a.jsx(z,{src:G.userAvatar,alt:G.userName}),a.jsx(E,{className:"bg-linear-to-br from-primary to-accent text-white font-bold",children:G.userName[0]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-semibold text-sm",children:G.petName}),a.jsx("p",{className:"text-white/80 text-xs",children:Ae(G.createdAt)})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(U,{variant:"ghost",size:"icon",onClick:se,className:"text-white hover:bg-white/20","aria-label":S?"Play story":"Pause story",children:S?a.jsx(x,{size:20,weight:"fill"}):a.jsx(p,{size:20,weight:"fill"})}),"video"===G.type&&a.jsx(U,{variant:"ghost",size:"icon",onClick:ae,className:"text-white hover:bg-white/20","aria-label":C?"Unmute video":"Mute video",children:C?a.jsx(f,{size:20,weight:"fill"}):a.jsx(y,{size:20,weight:"fill"})}),a.jsx(U,{variant:"ghost",size:"icon",onClick:J,className:"text-white hover:bg-white/20","aria-label":X?"Exit fullscreen":"Enter fullscreen",children:X?a.jsx(v,{size:20,weight:"fill"}):a.jsx(b,{size:20,weight:"fill"})}),V&&a.jsxs(pe,{children:[a.jsx(fe,{asChild:!0,children:a.jsx(U,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20","aria-label":"Story options",children:a.jsx(w,{size:24,weight:"bold"})})}),a.jsxs(ye,{align:"end",className:"bg-background/95 backdrop-blur-lg",children:[a.jsxs(ve,{onClick:Ie,children:[a.jsx(g,{size:18,className:"mr-2"}),"Save to Highlight"]}),a.jsxs(ve,{onClick:Fe,children:[a.jsx(j,{size:18,className:"mr-2"}),"Share Story"]})]})]}),a.jsx(U,{variant:"ghost",size:"icon",onClick:l,className:"text-white hover:bg-white/20","aria-label":"Close story viewer",children:a.jsx(d,{size:24,weight:"bold"})})]})]})]}),a.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[a.jsx("div",{className:"flex-1 cursor-w-resize","aria-label":"Previous story"}),a.jsx("div",{className:"flex-1 cursor-e-resize","aria-label":"Next story"})]}),a.jsxs(me,{ref:Y,className:"relative w-full h-full max-w-2xl mx-auto touch-none",style:[Re,be,we],children:["photo"===G.type&&a.jsx(me,{style:Le.animatedStyle,children:a.jsx("img",{src:G.mediaUrl,alt:G.caption||"Story",className:"w-full h-full object-contain select-none",draggable:!1})},G.id),"video"===G.type&&a.jsx("video",{ref:$,src:G.mediaUrl,className:"w-full h-full object-contain",autoPlay:!0,loop:!0,muted:C,playsInline:!0,"aria-label":`Video story by ${G.userName}`}),G.caption&&a.jsx("div",{className:"absolute bottom-24 left-0 right-0 px-4",children:a.jsx(me,{className:"glass-strong p-4 rounded-2xl backdrop-blur-xl",style:Te.animatedStyle,children:a.jsx("p",{className:"text-white text-center",children:G.caption})})})]}),!V&&a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 z-20 p-4 space-y-3",children:[a.jsx(je,{children:L&&a.jsx(me,{style:Ue.animatedStyle,className:"glass-strong p-4 rounded-2xl backdrop-blur-xl",role:"dialog","aria-label":"React to story",children:a.jsx("div",{className:"flex justify-center gap-4",children:ke.map(e=>a.jsx(me,{as:"button",className:"text-4xl focus:outline-none focus:ring-2 focus:ring-white rounded-lg p-2",style:[Ee.animatedStyle,De.animatedStyle],onMouseEnter:Ee.handleEnter,onMouseLeave:Ee.handleLeave,onClick:()=>{De.handlePress(),Se(e)},"aria-label":`React with ${e}`,children:e},e))})},"reactions")}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(D,{value:T,onChange:e=>M(e.target.value),onKeyDown:e=>{"Enter"===e.key&&Ce()},placeholder:"Send a reply...",className:"glass-strong border-white/30 text-white placeholder:text-white/60 pr-12 backdrop-blur-xl","aria-label":"Reply to story"}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>R(!L),className:"absolute right-1 top-1/2 -translate-y-1/2 text-white hover:bg-white/20","aria-label":L?"Hide reactions":"Show reactions","aria-pressed":L,children:a.jsx(N,{size:20,weight:L?"fill":"regular"})})]}),a.jsx(U,{onClick:Ce,disabled:!T.trim(),size:"icon",className:"shrink-0 bg-white text-black hover:bg-white/90","aria-label":"Send reply",children:a.jsx(j,{size:20,weight:"fill"})})]})]}),V&&a.jsx("div",{className:"absolute bottom-4 left-4 right-4 z-20",children:a.jsx(me,{className:"glass-strong p-4 rounded-2xl backdrop-blur-xl",style:Me.animatedStyle,role:"region","aria-label":"Story analytics",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-white text-2xl font-bold",children:G.viewCount}),a.jsx("p",{className:"text-white/60 text-xs",children:"Views"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-white text-2xl font-bold",children:G.reactions.length}),a.jsx("p",{className:"text-white/60 text-xs",children:"Reactions"})]})]}),a.jsx(U,{variant:"ghost",size:"sm",className:"text-white","aria-label":"View detailed insights",children:"View Insights"})]})})})]}),O&&G&&a.jsx($e,{open:O,onOpenChange:B,story:G,onSaved:()=>{B(!1)}})]}):null}const We=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));function Ge({highlight:e,currentUserId:t,currentUserName:i,currentUserAvatar:r,onClose:n}){const[,l]=ae("story-highlights",[]),[o,c]=s.useState(!1),[u,m]=s.useState(0),g=e.userId===t;return o?a.jsx(Ye,{stories:e.stories,initialIndex:u,currentUserId:t,currentUserName:i,...void 0!==r?{currentUserAvatar:r}:{},onClose:()=>c(!1)}):a.jsx(F,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-end sm:items-center justify-center p-0 sm:p-4",onClick:n,children:a.jsxs(F,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300},className:"w-full max-w-2xl bg-background rounded-t-3xl sm:rounded-3xl overflow-hidden shadow-2xl max-h-[90vh] flex flex-col",onClick:e=>e.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-2xl font-bold truncate",children:e.title}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[e.stories.length," ",1===e.stories.length?"story":"stories"]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[g&&a.jsxs(a.Fragment,{children:[a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>{Z.trigger("selection"),l(t=>(t||[]).map(t=>t.id===e.id?{...t,isPinned:!t.isPinned}:t)),h.success(e.isPinned?"Unpinned":"Pinned",{duration:1500})},className:"shrink-0",children:e.isPinned?a.jsx(S,{size:20,weight:"fill"}):a.jsx(k,{size:20})}),a.jsx(U,{variant:"ghost",size:"icon",onClick:()=>{Z.trigger("warning"),l(t=>(t||[]).filter(t=>t.id!==e.id)),h.success("Highlight deleted",{duration:2e3}),n()},className:"shrink-0 text-destructive hover:text-destructive",children:a.jsx(C,{size:20,weight:"bold"})})]}),a.jsx(U,{variant:"ghost",size:"icon",onClick:n,className:"shrink-0",children:a.jsx(d,{size:24,weight:"bold"})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsx("div",{className:"grid grid-cols-3 gap-3",children:e.stories.map((e,t)=>a.jsxs(F,{as:"button",onClick:()=>(e=>{Z.trigger("light"),m(e),c(!0)})(t),className:"aspect-[9/16] rounded-2xl overflow-hidden relative group",whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.03*t},children:[a.jsx("img",{src:e.thumbnailUrl||e.mediaUrl,alt:e.caption||`Story ${t+1}`,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),e.caption&&a.jsx("div",{className:"absolute bottom-2 left-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx("p",{className:"text-white text-xs line-clamp-2 font-medium drop-shadow-lg",children:e.caption})}),"video"===e.type&&a.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-black/70 backdrop-blur-sm rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xs",children:"â–¶"})})]},e.id))})})]})})}function Ve({open:e,onOpenChange:t,existingHighlight:r}){const[l]=ae("stories",[]),[o]=ae("user-pets",[]),[c]=ae("current-user",{id:"user-1",name:"User"}),[,d]=ae("story-highlights",[]),[u,m]=s.useState((null==r?void 0:r.title)||""),[g,x]=s.useState(new Set((null==r?void 0:r.stories.map(e=>e.id))||[])),[p,f]=s.useState((null==r?void 0:r.coverImage)||""),y=Ee((l||[]).filter(e=>e.userId===((null==c?void 0:c.id)||"user-1")));s.useEffect(()=>{if(g.size>0&&!p){const e=y.find(e=>g.has(e.id));e&&f(e.thumbnailUrl||e.mediaUrl)}},[g,y,p]);const v=()=>{m(""),x(new Set),f("")};return a.jsx(_,{open:e,onOpenChange:t,children:a.jsxs(H,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs($,{children:[a.jsx(Y,{children:r?"Edit Highlight":"Create Highlight"}),a.jsx(ie,{children:"Save your favorite stories to a permanent highlight collection"})]}),a.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(O,{htmlFor:"highlight-title",children:"Highlight Title"}),a.jsx(D,{id:"highlight-title",value:u,onChange:e=>m(e.target.value),placeholder:"e.g., Summer Adventures, Best Moments",maxLength:30}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.length,"/30 characters"]})]}),0===y.length?a.jsxs("div",{className:"py-12 text-center",children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:"You don't have any active stories yet"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Create some stories first to add them to highlights"})]}):a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsxs(O,{className:"mb-3 block",children:["Select Stories (",g.size,")"]}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:y.map((e,t)=>{const s=g.has(e.id),i=p===(e.thumbnailUrl||e.mediaUrl);return a.jsxs(F,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.03*t},className:"relative",children:[a.jsxs("button",{onClick:()=>{return t=e.id,Z.trigger("selection"),void x(e=>{const s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s});var t},className:"aspect-[9/16] rounded-2xl overflow-hidden relative group w-full border-2 transition-all "+(s?"border-primary shadow-lg":"border-transparent hover:border-border"),children:[a.jsx("img",{src:e.thumbnailUrl||e.mediaUrl,alt:e.caption||"Story",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity"}),s&&a.jsx(F,{initial:{scale:0},animate:{scale:1},className:"absolute top-2 right-2 w-6 h-6 bg-primary rounded-full flex items-center justify-center shadow-lg",children:a.jsx(n,{size:16,weight:"bold",className:"text-white"})}),i&&a.jsx("div",{className:"absolute bottom-2 left-2 right-2",children:a.jsx("div",{className:"bg-primary/90 backdrop-blur-sm rounded-lg px-2 py-1",children:a.jsx("p",{className:"text-white text-xs font-semibold text-center",children:"Cover"})})})]}),s&&!i&&a.jsx(U,{onClick:()=>(e=>{Z.trigger("light"),f(e.thumbnailUrl||e.mediaUrl),h.success("Cover image set",{duration:1500})})(e),variant:"secondary",size:"sm",className:"absolute bottom-2 left-2 right-2 text-xs h-7",children:"Set as Cover"})]},e.id)})})]})})]}),a.jsxs(re,{children:[a.jsx(U,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),a.jsxs(U,{onClick:()=>{if(!u.trim())return void h.error("Please enter a title");if(0===g.size)return void h.error("Please select at least one story");Z.trigger("success");const e=y.filter(e=>g.has(e.id)),s=null==o?void 0:o[0];if(r)d(t=>(t||[]).map(t=>t.id===r.id?{...t,title:u,coverImage:p,stories:e,updatedAt:(new Date).toISOString()}:t)),h.success("Highlight updated!");else{const t=ze((null==c?void 0:c.id)||"user-1",(null==s?void 0:s.id)||"pet-1",u,p,e);d(e=>[...e||[],t]),h.success("Highlight created!")}t(!1),v()},disabled:!u.trim()||0===g.size,className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:[a.jsx(i,{size:18,weight:"bold",className:"mr-2"}),r?"Update":"Create"," Highlight"]})]})]})})}function qe({petId:e,userId:t,onlyOwn:r=!1}){const[n]=ae("story-highlights",[]),[l]=ae("current-user",{id:"user-1",name:"User"}),[o,c]=s.useState(null),[d,u]=s.useState(!1),m=[...(n||[]).filter(s=>e?s.petId===e:t?s.userId===t:!r||s.userId===((null==l?void 0:l.id)||"user-1"))].sort((e,t)=>e.isPinned!==t.isPinned?e.isPinned?-1:1:new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime());return 0!==m.length||r?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("div",{className:"flex gap-4 pb-2 min-w-min",children:[r&&a.jsxs(F,{as:"button",onClick:()=>{Z.trigger("selection"),u(!0)},className:"flex flex-col items-center gap-2 shrink-0 group",whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-muted to-muted/50 flex items-center justify-center border-2 border-dashed border-border group-hover:border-primary transition-colors",children:a.jsx(i,{size:28,className:"text-muted-foreground group-hover:text-primary transition-colors",weight:"bold"})})}),a.jsx("span",{className:"text-xs font-medium text-muted-foreground max-w-[80px] truncate",children:"New"})]}),m.map((e,t)=>{var s,i;return a.jsxs(F,{as:"button",onClick:()=>{Z.trigger("light"),c(e)},className:"flex flex-col items-center gap-2 shrink-0 group",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},whileHover:{scale:1.05},whileTap:{scale:.95},children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-primary via-accent to-secondary p-[2px]",children:a.jsx("div",{className:"w-full h-full rounded-full bg-background"})}),a.jsxs(P,{className:"w-20 h-20 relative ring-2 ring-background",children:[a.jsx(z,{src:e.coverImage,alt:e.title,className:"object-cover"}),a.jsx(E,{className:"bg-gradient-to-br from-primary to-accent text-white font-bold text-xl",children:(null==(i=null==(s=e.title)?void 0:s[0])?void 0:i.toUpperCase())??"H"})]}),e.isPinned&&a.jsx(F,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 w-5 h-5 bg-accent rounded-full flex items-center justify-center shadow-lg border-2 border-background",children:a.jsx("span",{className:"text-[10px]",children:"ðŸ“Œ"})}),a.jsx("div",{className:"absolute bottom-0 right-0 w-5 h-5 bg-primary/90 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg text-[10px] font-bold text-white border border-background",children:e.stories.length})]}),a.jsx("span",{className:"text-xs font-medium text-foreground max-w-[80px] truncate text-center leading-tight",children:e.title})]},e.id)})]})}),o&&a.jsx(Ge,{highlight:o,currentUserId:(null==l?void 0:l.id)||"user-1",currentUserName:(null==l?void 0:l.name)||"User",onClose:()=>c(null)}),d&&a.jsx(Ve,{open:d,onOpenChange:u})]}):null}export{qe as H,Me as S,We as a};
